"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91701],{349153:function(e,s,t){var a=t(552322),i=t(742951),r=t.n(i),l=t(202784),o=t(783112),n=t(412524),p=t.n(n),u=t(307411),d=t(923466),c=t(53384),m=t(560475),g=t(788028),f=t(558001),h=t(355125),x=t(293786),y=t(398804),b=t(850358),S=t(904845),w=t(677350);let k={edit:{title:"builder.common.admin.edit.title",description:"builder.common.admin.edit.desc"},publish:{title:"builder.common.admin.publish.title",description:"builder.common.admin.publish.desc"}},I={edit:"builder.common.edit",publish:"component.builderHeader.publish"};s.Z=(0,h.d2)((0,b.Df)(e=>{let{storyType:s,authManager:t,config:i,storyItem:n}=e,h=(0,o.Z)(),b=(0,l.useRef)(),[P,W]=(0,l.useState)(void 0),[j,L]=(0,l.useState)(!1),[Z,C]=(0,l.useState)("edit"),v="admin"===n.itemDetails.itemControl,T=t?.username===n.itemDetails.owner,_=e=>new Promise(s=>{R(e,s)}),R=(e,s)=>{b.current=s,C(e),L(!0)},E=()=>{M(!1),A()},M=e=>{b.current&&b.current(e),L(!1)},A=()=>{if("edit"===Z){let e=n.itemId,t=(0,u.N)(s,n.isTemplate),a=s===x.o.Theme?`/${t}`:`/${t}/view?id=${e}`,r=s===x.o.Theme?`${i.BASE_URL}/${t}`:`${i.BASE_URL}/${t}/${e}`;(0,S.j)({href:a,asPath:r})}};(0,l.useEffect)(()=>{(async()=>{if(t)return await (0,y.Ke)({username:n.itemDetails.owner,portalHost:i.PORTAL_HOST,authManager:t})})().then(e=>W(e)),L(v&&!T),n.setConfirmAdminAction(v&&!T?_:void 0)},[]);let F={styles:(0,a.jsx)(r(),{id:"647cfcc1b3b0bd00",dynamic:[Math.max(c.y$,d.q.zIndex)+1],children:`.admin-messaging-modal-portal.__jsx-style-dynamic-selector{z-index:${Math.max(c.y$,d.q.zIndex)+1}}`}),className:r().dynamic([["647cfcc1b3b0bd00",[Math.max(c.y$,d.q.zIndex)+1]]])},N=k[Z].title,$=k[Z].description,D=I[Z];return(0,a.jsxs)(m.Z,{headerTitle:h.formatMessage({id:N}),isShowingModal:j,primaryButtonTitle:h.formatMessage({id:D}),onPrimaryButtonClick:()=>{M(!0)},onSecondaryButtonClick:E,onCloseButtonClick:E,secondaryButtonTitle:h.formatMessage({id:"common.cancel"}),closeButtonLabel:h.formatMessage({id:"common.close"}),portalClassNames:p()("admin-messaging-modal-portal",F.className),children:[(0,a.jsx)("p",{children:h.formatMessage({id:$})}),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:r().dynamic([["ec1093a417bcaf4c",[g.default.spacing.xxxs,f.ZP.typography.subtitleSmall()]]])+" owner-info",children:[(0,a.jsx)(w.F,{authManager:t,user:P,intl:h,config:i},P?.username),(0,a.jsx)("span",{className:r().dynamic([["ec1093a417bcaf4c",[g.default.spacing.xxxs,f.ZP.typography.subtitleSmall()]]])+" owner-fullname",children:P?.fullName})]}),(0,a.jsx)(r(),{id:"ec1093a417bcaf4c",dynamic:[g.default.spacing.xxxs,f.ZP.typography.subtitleSmall()],children:`.owner-info.__jsx-style-dynamic-selector{display:grid;grid-column-gap:${g.default.spacing.xxxs};grid-template-columns:auto 1fr;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.owner-fullname.__jsx-style-dynamic-selector{${f.ZP.typography.subtitleSmall()}
            }`})]}),F.styles]})}))},826750:function(e,s,t){var a=t(552322),i=t(742951),r=t.n(i),l=t(202784),o=t(342670),n=t(819233),p=t(788028),u=t(889322),d=t(362851),c=t(293786),m=t(863982),g=t(567523),f=t(183351),h=t(923466),x=t(528304);class y extends l.PureComponent{async componentDidMount(){try{await this.props.storyItem.confirmDataLossBeforeSave(),await this.props.storyItem.discardUnpublishedChanges(),await this.invalidateCache(),await this.props.fetchStoryData(),this.next()}catch(e){if(e instanceof Error&&e.message===m.J8){this.props.onClose();return}this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.discardUnpublished.error.message"})}),this.props.onClose()}}render(){return(0,a.jsxs)("div",{className:r().dynamic([["a75db31b172f2456",[p.default.color.white,h.q.zIndex]]])+" discard-unpublished-workflow",children:[(0,a.jsx)(u.nj.Controller,{onFinish:this.props.onFinish,children:(e,s)=>(this.next=s,(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(n.ZP,{}),(0,a.jsx)(u.nj.Stage,{order:1,delay:h.q.stageDelay,...e,children:(0,a.jsx)(f.Z,{message:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.discardUnpublished.discarding.message"})})}),(0,a.jsx)(u.nj.Stage,{order:2,delay:h.q.stageDelay,onStageReady:this.next,...e,children:(0,a.jsx)(x.Z,{message:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.discardUnpublished.${this.props.itemType}.success.message`})})})]}))}),(0,a.jsx)(r(),{id:"a75db31b172f2456",dynamic:[p.default.color.white,h.q.zIndex],children:`.discard-unpublished-workflow.__jsx-style-dynamic-selector{position:fixed;height:100vh;width:100vw;top:0;right:0;background-color:${p.default.color.white};z-index:${h.q.zIndex}}`})]})}constructor(...e){super(...e),this.invalidateCache=async()=>{if(this.props.itemType!==c.o.Theme){let e=this.props.storyRouting.getUrlFromRouteDef({route:"invalidate-gemini-item-cache",itemId:this.props.storyItem.itemId,itemType:this.props.itemType});e&&await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`token=${this.props.storyItem.authManager.token}`})}}}}s.Z=(0,g.Jy)((0,d.ZP)(y))},92044:function(e,s,t){t.d(s,{Z:function(){return ew}});var a=t(552322),i=t(742951),r=t.n(i),l=t(202784),o=t(342670),n=t(289274),p=t(819233),u=t(788028),d=t(889322),c=t(362851),m=t(566860),g=t(873329),f=t(136630);let h=()=>{let e,s;let t=new Promise((t,a)=>{e=t,s=a});return{resolve:e,reject:s,promise:t}};var x=t(348206),y=t(659882),b=t(69378),S=t(705548);let w=e=>e.authManager&&e.authManager.portal?e.authManager.portal:`https://${e.portalHost}/sharing/rest`,k=(e,s,t)=>`${w(t)}/content/users/${s}/items/${e}`,I=async(e,s)=>{if(s.rules.sharing&&s.rules.sharing.appProxy&&s.rules.sharing.appProxy.registerAppParams){let t=`${w(s)}/oauth2/registerApp`,a={itemId:e,appType:s.rules.sharing.appProxy.registerAppParams.appType,redirect_uris:JSON.stringify(s.rules.sharing.appProxy.registerAppParams.redirect_uris)};return(0,b.WY)(t,{authentication:s.authManager,params:a})}throw g.eW},P=async(e,s,t)=>{if(t.rules.sharing&&t.rules.sharing.appProxy){let a=t.rules.sharing.appProxy.existingAppProxy&&t.rules.sharing.appProxy.existingAppProxy.referrers||[],i=t.rules.sharing.appProxy.serviceProxyParams.referrers.concat(a).filter(S.z),r={...t.rules.sharing.appProxy.serviceProxyParams,referrers:i},l=`${k(e.id,e.owner,t)}/createProxies`;return(0,b.WY)(l,{authentication:t.authManager,params:{proxies:s,serviceProxyParams:r}})}throw g.Im},W=async(e,s)=>{try{if(s.rules.sharing&&s.rules.sharing.appProxy){let t=await (0,x.rV)(s.rules.sharing.appProxy.itemId,{authentication:s.authManager});(0,y.Mp)(t)||await I(t.id,s);let a=s.rules.sharing.appProxy.existingAppProxy&&s.rules.sharing.appProxy.existingAppProxy.proxies?s.rules.sharing.appProxy.existingAppProxy.proxies:[],i=e.map(e=>({sourceUrl:e.fixProperties.sourceUrl})).filter((e,s,t)=>t.indexOf(e)===s&&!a.find(s=>s.sourceUrl===e.sourceUrl)),r=await P(t,i,s);e.forEach(e=>{e.resolve(r)})}else e.forEach(e=>{e.reject(g.Im)})}catch(s){e.forEach(e=>{e.reject(s)})}},j=async()=>{throw g.Yn},L=async(e,s)=>{let t=[],a=[],i=[].concat(e).reduce((e,s)=>{let i=s.issue?s.issue:s;if(i.hasFix&&"function"==typeof i.fix)return e.concat(i.fix());if(i.hasFix&&"object"==typeof i.fix&&"app-proxy"===i.fix.type){if(a.includes(i.fix.sourceUrl))return e;a.push(i.fix.sourceUrl);let{resolve:s,reject:r,promise:l}=h();return t.push({fixProperties:i.fix,resolve:s,reject:r}),e.concat(l)}return e.concat(j())},[]);return t.length>0&&await W(t,s),(0,f.Lu)(i)};var Z=t(293786),C=t(368667),v=t(850358),T=t(863982),_=t(567523),R=t(183351),E=t(176086),M=t(790007),A=t(355125),F=t(578166),N=t(558001),$=t(103010),D=t(759067),U=t(186705),B=t(326860),z=t(641391),G=t(612423),O=t(537905),q=t(590004),J=t(765821),Y=t(344159),H=t(405189),K=t(445481),V=t(798396),X=t(447878),Q=t(994812),ee=t(764075);let es={sharing:"component.builderWorkflows.publishWorkflow.fixStage.sharing.item.layoutCount.plural",premium:"component.builderWorkflows.publishWorkflow.fixStage.premium.item.layoutCount.plural","secured-layer":"component.builderWorkflows.publishWorkflow.fixStage.sharing.item.layoutCount.plural"};var et=e=>{let{details:s,type:t}=e,{theme:i}=(0,M.Fj)(),o=(0,O.Z)(),[n,p]=(0,l.useState)(!1),d={styles:(0,a.jsx)(r(),{id:"91d576dacc33ba5",dynamic:[u.default.spacing.xxxs,n?"0":"-90deg",F.Kk.RTL,n?"0":"90deg"],children:`.icon.__jsx-style-dynamic-selector::after{content:"";margin-right:${u.default.spacing.xxxs}}.icon.__jsx-style-dynamic-selector svg{vertical-align:text-top;-webkit-transform:rotate(${n?"0":"-90deg"});-moz-transform:rotate(${n?"0":"-90deg"});-ms-transform:rotate(${n?"0":"-90deg"});-o-transform:rotate(${n?"0":"-90deg"});transform:rotate(${n?"0":"-90deg"})}${F.Kk.RTL} .icon.__jsx-style-dynamic-selector svg{-webkit-transform:rotate(${n?"0":"90deg"});-moz-transform:rotate(${n?"0":"90deg"});-ms-transform:rotate(${n?"0":"90deg"});-o-transform:rotate(${n?"0":"90deg"});transform:rotate(${n?"0":"90deg"})}`}),className:r().dynamic([["91d576dacc33ba5",[u.default.spacing.xxxs,n?"0":"-90deg",F.Kk.RTL,n?"0":"90deg"]]])},c=s.layerNames,m=c&&c.length>1;return(0,a.jsxs)(a.Fragment,{children:[m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{p(!n)},className:r().dynamic([["3e0588e420afe7ea",[F._F.userIsNotTabbing,N.ZP.typography.caption(),"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous,u.default.spacing.xxxxs,F._F.userIsNotTabbing,N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}}),i.colors.labelSecondary,u.default.spacing.xxxxxs]]])+" layer-changes",children:[(0,a.jsx)($.Z,{className:d.className,path:ee.x,size:16,fill:i.colors.labelDangerous}),o(es[t],{layerCount:c.length})]}),(0,a.jsx)("div",{className:r().dynamic([["3e0588e420afe7ea",[F._F.userIsNotTabbing,N.ZP.typography.caption(),"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous,u.default.spacing.xxxxs,F._F.userIsNotTabbing,N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}}),i.colors.labelSecondary,u.default.spacing.xxxxxs]]])+" "+`layer-details-wrapper ${n?"is-open":""}`,children:c.map(e=>(0,a.jsx)("p",{className:r().dynamic([["3e0588e420afe7ea",[F._F.userIsNotTabbing,N.ZP.typography.caption(),"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous,u.default.spacing.xxxxs,F._F.userIsNotTabbing,N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}}),i.colors.labelSecondary,u.default.spacing.xxxxxs]]])+" layer-details",children:`"${e}"`},e))})]}):(0,a.jsx)("p",{className:r().dynamic([["3e0588e420afe7ea",[F._F.userIsNotTabbing,N.ZP.typography.caption(),"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous,u.default.spacing.xxxxs,F._F.userIsNotTabbing,N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}}),i.colors.labelSecondary,u.default.spacing.xxxxxs]]])+" layer-changes",children:o(s.singularPermissionStringId,{layerName:c})}),d.styles,(0,a.jsx)(r(),{id:"3e0588e420afe7ea",dynamic:[F._F.userIsNotTabbing,N.ZP.typography.caption(),"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous,u.default.spacing.xxxxs,F._F.userIsNotTabbing,N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}}),i.colors.labelSecondary,u.default.spacing.xxxxxs],children:`${F._F.userIsNotTabbing} .layer-changes.__jsx-style-dynamic-selector:focus{outline:none}.layer-changes.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;${N.ZP.typography.caption()}
          color: ${"premium-issue-map-details"===s.type?i.colors.labelLink:i.colors.labelDangerous};margin-top:${u.default.spacing.xxxxs};overflow:hidden}${F._F.userIsNotTabbing} .layer-changes.__jsx-style-dynamic-selector:focus{outline:none}.layer-details-wrapper.__jsx-style-dynamic-selector{height:0;overflow:hidden;-webkit-padding-start:2.2rem;-moz-padding-start:2.2rem;padding-inline-start:2.2rem}.layer-details-wrapper.is-open.__jsx-style-dynamic-selector{height:auto}.layer-details.__jsx-style-dynamic-selector{${N.ZP.typography.caption({skip:["line-height"],lineClamp:{numLines:1}})}
          color: ${i.colors.labelSecondary};margin-top:${u.default.spacing.xxxxxs}}`})]})},ea=e=>{let s=(0,O.Z)(),t=(0,A.Pc)(),i=(0,v.ZR)(),l="sharing-issue-feature-layer-details"===e.details.type?V.dq.FeatureLayer:"sharing-issue-map-details"===e.details.type||"premium-issue-map-details"===e.details.type?V.dq.WebMap:"sharing-issue-portal-item-details"===e.details.type?V.dq.MobileMapPackage:X.j3,o=(0,C.pz)(e.details.itemId,i.PORTAL_HOST,t.authManager);return(0,a.jsxs)("div",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" item",children:[(0,a.jsx)("div",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" thumbnail"}),(0,a.jsxs)("div",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" info",children:[(0,a.jsxs)("div",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" info-top",children:[(0,a.jsx)(Q.Z,{itemType:l}),(0,a.jsxs)("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" anchor-wrapper",children:[(0,a.jsx)("h6",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]]),children:e.details.title}),(0,a.jsx)($.Z,{path:q.D,size:16,className:"launch-icon"})]})]}),(0,a.jsx)(et,{type:e.type,details:e.details})]}),(0,a.jsxs)("div",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" issue-icons-container",children:[("sharing-issue-map-details"===e.details.type||"sharing-issue-feature-layer-details"===e.details.type||"sharing-issue-portal-item-details"===e.details.type||"sharing-issue-theme-details"===e.details.type)&&(0,a.jsxs)(a.Fragment,{children:[e.details.sharingLevels.private&&(0,a.jsx)("span",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" issue-icon",children:(0,a.jsx)(Y.Z,{usePositionFixed:!0,tooltipContent:s("common.arcgis.sharing.itemTooltip.private"),children:(0,a.jsx)(D._,{accessLevel:z.eJ.PRIVATE,color:u.default.color.coolGrey})})}),e.storyShareToLevel.access===z.eJ.PUBLIC&&e.details.sharingLevels.org&&(0,a.jsx)("span",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" issue-icon",children:(0,a.jsx)(Y.Z,{usePositionFixed:!0,tooltipContent:s("common.arcgis.sharing.itemTooltip.org"),children:(0,a.jsx)(D._,{accessLevel:z.eJ.ORG,color:u.default.color.coolGrey})})}),e.details.hasUnfixableIssues&&(0,a.jsx)(H.Xr,{usePositionFixed:!0,tooltip:s("component.builderWorkflows.publishWorkflow.fixStage.issue.iconTooltip"),dimension:"small",offset:u.default.spacing.xxxs})]}),"premium-issue-map-details"===e.details.type&&(0,a.jsx)("span",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" issue-icon",children:(0,a.jsx)(Y.Z,{usePositionFixed:!0,tooltipContent:s("component.builderWorkflows.publishWorkflow.fixStage.item.premiumContent.tooltip"),children:(0,a.jsx)(K.M,{width:u.default.spacing.xxs,height:u.default.spacing.xxs,fill:u.default.color.bleuDeFrance})})}),"secured-layers-map-details"===e.details.type&&(0,a.jsx)("span",{className:r().dynamic([["df4338f5187db037",[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs]]])+" issue-icon",children:(0,a.jsx)(Y.Z,{usePositionFixed:!0,tooltipContent:s("component.builderWorkflows.publishWorkflow.fixStage.secureMapLayer.iconTooltip"),children:(0,a.jsx)($.Z,{path:J.e,fill:u.default.color.coolGrey,size:16})})})]}),(0,a.jsx)(r(),{id:"df4338f5187db037",dynamic:[u.default.spacing.xs,u.default.spacing.xs,u.default.color.platinum,e.details.thumbnailUrl,u.default.color.platinum,u.default.spacing.xs,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}}),u.default.color.darkGreen,u.default.spacing.xxxs],children:`.item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-webkit-align-items:start;-moz-box-align:start;-ms-flex-align:start;align-items:start;padding:${u.default.spacing.xs} 0;margin:0 ${u.default.spacing.xs}}.item.__jsx-style-dynamic-selector:not(:first-child){border-top:1px solid ${u.default.color.platinum}}.thumbnail.__jsx-style-dynamic-selector{height:4rem;width:6.8rem;background-image:url(${e.details.thumbnailUrl});background-position:center;background-repeat:no-repeat;-webkit-background-size:cover;-moz-background-size:cover;-o-background-size:cover;background-size:cover;background-color:${u.default.color.platinum};-webkit-box-flex:0;-webkit-flex:0 0 auto;-moz-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.info.__jsx-style-dynamic-selector{margin:0 ${u.default.spacing.xs};-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-width:0}.info-top.__jsx-style-dynamic-selector{${N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"})}
        }.info-top.__jsx-style-dynamic-selector .launch-icon{opacity:0}.info-top.__jsx-style-dynamic-selector:hover .launch-icon{opacity:1}.anchor-wrapper.__jsx-style-dynamic-selector{${N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.xxxs,alignItems:"center",justifyContent:"start"})}
        }h6.__jsx-style-dynamic-selector{${N.ZP.typography.bodySmall({skip:["line-height"],lineClamp:{numLines:1}})}
          color: ${u.default.color.darkGreen};margin:0}.issue-icons-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-webkit-flex:0 0 auto;-moz-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center}.issue-icon.__jsx-style-dynamic-selector:not(:first-child)::before{content:"";margin-right:${u.default.spacing.xxxs}}`})]})};let ei={[Z.o.Story]:{"sharing-theme-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.theme.title",description:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt1",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.theme.confirmFix"},"sharing-feature-layer-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-mixed":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"premium-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.premium.confirmFix"},"sharing-portal-item-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"}},[Z.o.Frame]:{"sharing-theme-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.theme.title",description:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt1",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.theme.confirmFix"},"sharing-feature-layer-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-mixed":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"premium-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.premium.confirmFix"},"sharing-portal-item-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"}},[Z.o.Briefing]:{"sharing-theme-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.theme.title",description:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt1",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.theme.confirmFix"},"sharing-feature-layer-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-mixed":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"premium-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.premium.confirmFix"},"sharing-portal-item-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"}},[Z.o.Collection]:{"sharing-theme-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.theme.title",description:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt1",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.theme.confirmFix"},"sharing-feature-layer-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-mixed":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"premium-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.premium.confirmFix"},"sharing-portal-item-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"}},[Z.o.Theme]:{"sharing-theme-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.theme.title",description:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt1",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.theme.confirmFix"},"sharing-feature-layer-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle.theme",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"sharing-mixed":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle.theme",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"},"premium-map-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.premium.confirmFix"},"sharing-portal-item-only":{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.subtitle",confirmFix:"component.builderWorkflows.publishWorkflow.fixStage.sharing.confirmFix"}}},er=(e,s)=>{let t=!!s.mapsWithIssues.length;if("premium"===e)return t?"premium-map-only":"no-issue";let a=!!s.themeWithIssue,i=!!s.featureLayersWithIssues&&!!s.featureLayersWithIssues.length,r=!!s.portalItemWithIssues&&!!s.portalItemWithIssues.length;return[t,a,i,r].filter(e=>!0===e).length>1?"sharing-mixed":a?"sharing-theme-only":t?"sharing-map-only":i?"sharing-feature-layer-only":r?"sharing-portal-item-only":"no-issue"};var el=e=>{let{theme:s}=(0,M.Fj)(),{authManager:t}=(0,A.Pc)(),i=(0,O.Z)(),[n,d]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"sharing"===e.type&&(0,G.KZ)(e.storyShareToLevel,t).then(e=>{d(e)})},[]);let c={styles:(0,a.jsx)(r(),{id:"3fe8d1169842db33",children:".icon.jsx-3fe8d1169842db33{line-height:1em;vertical-align:text-bottom}"}),className:"jsx-3fe8d1169842db33"},m={styles:(0,a.jsx)(r(),{id:"6b0f206e654245ae",dynamic:[u.default.spacing.xxs],children:`.icon.__jsx-style-dynamic-selector{-webkit-margin-end:${u.default.spacing.xxs};-moz-margin-end:${u.default.spacing.xxs};margin-inline-end:${u.default.spacing.xxs}}`}),className:r().dynamic([["6b0f206e654245ae",[u.default.spacing.xxs]]])},g=e.storyShareToLevel.access!==z.eJ.PRIVATE&&e.storyShareToLevel.access!==z.eJ.SHARED,f=e.storyShareToLevel.groups&&e.storyShareToLevel.groups.length>0?e.storyShareToLevel.groups.length:0,h=er(e.type,e.issueReport);return"no-issue"===h?null:(0,a.jsxs)("div",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" issue-report-stage",children:[(0,a.jsx)("button",{type:"button","aria-label":i("common.close"),onClick:e.onClose,className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" close-btn",children:(0,a.jsx)($.Z,{path:E.d,size:32,fill:s.colors.labelSecondary})}),(0,a.jsx)("h2",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" issues-header",children:(0,a.jsx)(o.Z,{id:ei[e.itemType][h].title})}),(0,a.jsx)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:ei[e.itemType][h].description})}),"sharing-theme-only"===h&&(0,a.jsx)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.theme.subtitle.pt2"})}),(0,a.jsxs)("div",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-wrapper",children:[(0,a.jsx)(p.in,{children:(0,a.jsxs)("div",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-details",children:[e.issueReport.mapsWithIssues.map(s=>(0,a.jsx)(ea,{details:s,storyShareToLevel:e.storyShareToLevel,type:e.type},s.itemId)),e.issueReport.featureLayersWithIssues?.map(s=>a.jsx(ea,{details:s,storyShareToLevel:e.storyShareToLevel,type:e.type},s.itemId)),e.issueReport.portalItemWithIssues?.map(s=>a.jsx(ea,{details:s,storyShareToLevel:e.storyShareToLevel,type:e.type},s.itemId)),void 0!==e.issueReport.themeWithIssue&&(0,a.jsx)(ea,{details:e.issueReport.themeWithIssue,storyShareToLevel:e.storyShareToLevel,type:"sharing"})]})}),"sharing"===e.type&&(0,a.jsxs)("div",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-footer",children:[(0,a.jsx)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level-before",children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.detailsFooter.changingTo"})}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D._,{accessLevel:e.storyShareToLevel.access,color:u.default.color.cadet,className:c.className}),(0,a.jsxs)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level",children:[(0,a.jsx)(o.Z,{id:{[z.eJ.PUBLIC]:"common.arcgis.sharing.display.public",[z.eJ.ORG]:"common.arcgis.sharing.display.org",[z.eJ.PRIVATE]:"common.arcgis.sharing.display.private",[z.eJ.SHARED]:"common.arcgis.sharing.display.groups"}[e.storyShareToLevel.access]}),f>0?"; ":""]})]}),f>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D._,{accessLevel:z.eJ.SHARED,color:u.default.color.cadet,className:c.className}),(0,a.jsxs)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level",children:[`${f} `,(0,a.jsx)(o.Z,{id:f>1?"common.arcgis.sharing.display.groups":"common.arcgis.sharing.display.group"})]})]})]})]}),"sharing"===e.type&&n&&e.storyShareToLevel.access!==z.eJ.PUBLIC&&(0,a.jsx)(U.Z,{size:"small",marginTop:u.default.spacing.xs,children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.updateGroupCapabilities"})}),!!e.issueReport.mapsWithIssues.length&&(0,a.jsx)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:{sharing:"component.builderWorkflows.publishWorkflow.fixStage.sharing.placeholderWarning",premium:"component.builderWorkflows.publishWorkflow.fixStage.premium.placeholderWarning"}[e.type]})}),e.issueReport.themeWithIssue&&(0,a.jsx)("p",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.sharing.themeWarning",values:{defaultTheme:(0,a.jsx)(o.Z,{id:"builder.designPanel.themes.summit.name"})}})}),(0,a.jsxs)("div",{className:r().dynamic([["d6716ab634531223",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" actions",children:[(0,a.jsx)(B.ZP,{type:"text",onClick:e.onSkipFix,children:(0,a.jsx)(o.Z,{id:{sharing:"component.builderWorkflows.publishWorkflow.fixStage.sharing.skipFix",premium:"component.builderWorkflows.publishWorkflow.fixStage.premium.skipFix"}[e.type]})}),(0,a.jsx)(B.ZP,{onClick:e.onConfirmFix,children:(0,a.jsx)(o.Z,{id:ei[e.itemType][h].confirmFix})})]}),m.styles,c.styles,(0,a.jsx)(r(),{id:"d6716ab634531223",dynamic:[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,F.Kk.RTL,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs],children:`.close-btn.__jsx-style-dynamic-selector{position:absolute;padding:${u.default.spacing.xxs};top:${u.default.spacing.xxxs};right:${u.default.spacing.xxxs}}${F.Kk.RTL} .close-btn.__jsx-style-dynamic-selector{right:unset;left:${u.default.spacing.xxxs}}.issue-report-stage.__jsx-style-dynamic-selector,.issue-report-stage.__jsx-style-dynamic-selector a.__jsx-style-dynamic-selector{text-align:start;color:${u.default.color.darkGreen};max-width:63rem}h2.__jsx-style-dynamic-selector{${N.ZP.typography.headingLarge()}
          margin: 0 0 ${u.default.spacing.sm} 0;}p.__jsx-style-dynamic-selector{${N.ZP.typography.bodySmall()}
          margin: 0;}.item-wrapper.__jsx-style-dynamic-selector{border:1px solid ${u.default.color.beauBlue}}.item-details.__jsx-style-dynamic-selector{max-height:28.4rem;overflow:auto;-webkit-overflow-scrolling:touch}.item-footer.__jsx-style-dynamic-selector{padding:${u.default.spacing.xxs} ${u.default.spacing.sm};background-color:${u.default.color.platinum};border-top:1px solid ${u.default.color.beauBlue}}.sharing-level-before.__jsx-style-dynamic-selector{display:inline-block}.sharing-level-before.__jsx-style-dynamic-selector::after{content:"";margin-left:${u.default.spacing.xxxs}}.sharing-level.__jsx-style-dynamic-selector{display:inline-block;${N.ZP.typography.bodySmall()}
          margin: 0 0.5rem;cursor:default}.tooltip{z-index:9999}.issues-header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-webkit-align-items:flex-end;-moz-box-align:end;-ms-flex-align:end;align-items:flex-end}.actions.__jsx-style-dynamic-selector{margin:${u.default.spacing.xl} 0 ${u.default.spacing.sm};${N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"})}
        }.report-description.__jsx-style-dynamic-selector{margin:${u.default.spacing.xs} 0}`})]})},eo=t(407862);let en={[Z.o.Story]:{"secured-layer":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.subtitle.p1"},sharing:{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.subtitle"}},[Z.o.Frame]:{"secured-layer":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.subtitle.p1"},sharing:{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.subtitle"}},[Z.o.Briefing]:{"secured-layer":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.subtitle.p1"},sharing:{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.subtitle"}},[Z.o.Collection]:{"secured-layer":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.subtitle.p1"},sharing:{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.subtitle"}},[Z.o.Theme]:{"secured-layer":{title:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.subtitle.p1.theme"},sharing:{title:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.title",description:"component.builderWorkflows.publishWorkflow.fixStage.sharing.unsharableContent.subtitle"}}},ep={[Z.o.Story]:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.placeholderWarning",[Z.o.Collection]:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.placeholderWarning",[Z.o.Frame]:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.placeholderWarning",[Z.o.Briefing]:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.placeholderWarning",[Z.o.Theme]:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.placeholderWarning.theme"},eu=(e,s)=>{let t=!!s.mapsWithIssues.length;return"secured-layer"===e?t?"secured-layer":"no-issue":t?"sharing":"no-issue"};var ed=e=>{let{theme:s}=(0,M.Fj)(),{authManager:t}=(0,A.Pc)(),i=(0,O.Z)(),[n,d]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"sharing"===e.type&&(0,G.KZ)(e.storyShareToLevel,t).then(e=>{d(e)})},[]);let c={styles:(0,a.jsx)(r(),{id:"3fe8d1169842db33",children:".icon.jsx-3fe8d1169842db33{line-height:1em;vertical-align:text-bottom}"}),className:"jsx-3fe8d1169842db33"},m={styles:(0,a.jsx)(r(),{id:"6b0f206e654245ae",dynamic:[u.default.spacing.xxs],children:`.icon.__jsx-style-dynamic-selector{-webkit-margin-end:${u.default.spacing.xxs};-moz-margin-end:${u.default.spacing.xxs};margin-inline-end:${u.default.spacing.xxs}}`}),className:r().dynamic([["6b0f206e654245ae",[u.default.spacing.xxs]]])},g=e.storyShareToLevel.access!==z.eJ.PRIVATE&&e.storyShareToLevel.access!==z.eJ.SHARED,f=e.storyShareToLevel.groups&&e.storyShareToLevel.groups.length>0?e.storyShareToLevel.groups.length:0,h=eu(e.type,e.issueReport);return"no-issue"===h?null:(0,a.jsxs)("div",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" issue-report-stage",children:[(0,a.jsx)("button",{type:"button","aria-label":i("common.close"),onClick:e.onClose,className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" close-btn",children:(0,a.jsx)($.Z,{path:E.d,size:32,fill:s.colors.labelSecondary})}),(0,a.jsxs)("h2",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" unfixable-issues-header",children:[e.issueReport.hasUnfixableIssues&&(0,a.jsx)($.Z,{path:eo.N,className:m.className,size:32}),(0,a.jsx)(o.Z,{id:en[e.itemType][h].title})]}),(0,a.jsx)("p",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:en[e.itemType][h].description})}),(0,a.jsxs)("div",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-wrapper",children:[(0,a.jsx)(p.in,{children:(0,a.jsx)("div",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-details",children:e.issueReport.mapsWithIssues.map(s=>(0,a.jsx)(ea,{details:s,storyShareToLevel:e.storyShareToLevel,type:e.type},s.itemId))})}),"sharing"===e.type&&(0,a.jsxs)("div",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" item-footer",children:[(0,a.jsx)("p",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level-before",children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.detailsFooter.changingTo"})}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D._,{accessLevel:e.storyShareToLevel.access,color:u.default.color.cadet,className:c.className}),(0,a.jsxs)("p",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level",children:[(0,a.jsx)(o.Z,{id:`common.arcgis.sharing.display.${e.storyShareToLevel.access}`}),f>0?"; ":""]})]}),f>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D._,{accessLevel:z.eJ.SHARED,color:u.default.color.cadet,className:c.className}),(0,a.jsxs)("p",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" sharing-level",children:[`${f} `,(0,a.jsx)(o.Z,{id:f>1?"common.arcgis.sharing.display.groups":"common.arcgis.sharing.display.group"})]})]})]})]}),"sharing"===e.type&&n&&e.storyShareToLevel.access!==z.eJ.PUBLIC&&(0,a.jsx)(U.Z,{size:"small",marginTop:u.default.spacing.xs,children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.updateGroupCapabilities"})}),(0,a.jsx)("p",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" report-description",children:(0,a.jsx)(o.Z,{id:ep[e.itemType]})}),(0,a.jsxs)("div",{className:r().dynamic([["1719f2a034c65fdd",[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs]]])+" actions",children:[(0,a.jsx)(B.ZP,{type:"text",onClick:e.onClose,children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.skipFix"})}),(0,a.jsx)(B.ZP,{onClick:e.onConfirmFix,children:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.confirmFix"})})]}),m.styles,c.styles,(0,a.jsx)(r(),{id:"1719f2a034c65fdd",dynamic:[u.default.spacing.xxs,u.default.spacing.xxxs,u.default.spacing.xxxs,u.default.color.darkGreen,N.ZP.typography.headingLarge(),u.default.spacing.sm,N.ZP.typography.bodySmall(),u.default.color.beauBlue,u.default.spacing.xxs,u.default.spacing.sm,u.default.color.platinum,u.default.color.beauBlue,u.default.spacing.xxxs,N.ZP.typography.bodySmall(),u.default.color.alertRed,u.default.spacing.xxs,N.ZP.typography.bodySmall(),u.default.spacing.xl,u.default.spacing.sm,N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"}),u.default.spacing.xs],children:`.close-btn.__jsx-style-dynamic-selector{position:absolute;padding:${u.default.spacing.xxs};top:${u.default.spacing.xxxs};right:${u.default.spacing.xxxs}}.issue-report-stage.__jsx-style-dynamic-selector,.issue-report-stage.__jsx-style-dynamic-selector a.__jsx-style-dynamic-selector{text-align:start;color:${u.default.color.darkGreen};max-width:63rem}h2.__jsx-style-dynamic-selector{${N.ZP.typography.headingLarge()}
          margin: 0 0 ${u.default.spacing.sm} 0;}p.__jsx-style-dynamic-selector{${N.ZP.typography.bodySmall()}
          margin: 0;}.item-wrapper.__jsx-style-dynamic-selector{border:1px solid ${u.default.color.beauBlue}}.item-details.__jsx-style-dynamic-selector{max-height:28.4rem;overflow:auto;-webkit-overflow-scrolling:touch}.item-footer.__jsx-style-dynamic-selector{padding:${u.default.spacing.xxs} ${u.default.spacing.sm};background-color:${u.default.color.platinum};border-top:1px solid ${u.default.color.beauBlue}}.sharing-level-before.__jsx-style-dynamic-selector{display:inline-block}.sharing-level-before.__jsx-style-dynamic-selector::after{content:"";margin-left:${u.default.spacing.xxxs}}.sharing-level.__jsx-style-dynamic-selector{display:inline-block;${N.ZP.typography.bodySmall()}
          margin: 0 0.5rem;cursor:default}.tooltip{z-index:9999}.unfixable-issues-warning.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:${u.default.color.alertRed};margin-top:${u.default.spacing.xxs};${N.ZP.typography.bodySmall()}
        }.unfixable-issues-header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-webkit-align-items:flex-end;-moz-box-align:end;-ms-flex-align:end;align-items:flex-end}.actions.__jsx-style-dynamic-selector{margin:${u.default.spacing.xl} 0 ${u.default.spacing.sm};${N.ZP.gapped({direction:"horizontal",gap:u.default.spacing.sm,alignItems:"center",justifyContent:"end"})}
        }.report-description.__jsx-style-dynamic-selector{margin:${u.default.spacing.xs} 0}`})]})},ec=t(923466),em=t(528304);let eg=e=>{if(e.type!==g.jJ.MAP_LAYER)return;let s=e.itemInfo;return(s.mapLayerData?.title||s.itemDetails?.title||s.mapLayerData?.url||s.mapLayerData?.id||e.itemId)??""},ef=e=>{let s=e=>void 0!==e.type,{issueItems:t,issuesReport:a,details:i}=e,r=!1,l="sharing-issue-map-details"===i.type;if(t.forEach(e=>{let t=s(e)?e:e.issue,o=s(e)?void 0:e.item,n=o&&eg(o);"sharing-access-level"===t.type?l&&t.hasFix?(r=!0,i.sharingLevels[t.currentSharingLevel.access]=!0,n&&i.layerNames.push(n)):l||(r=!0,i.sharingLevels[t.currentSharingLevel.access]=!0):l&&n&&"app-proxy-required"===t.type&&t.isPremiumContent?i.layerNames.push(n):l&&"app-proxy-required"===t.type&&t.isSubscriberContent&&!t.hasFix&&(r=!0,a.hasUnfixableIssues=!0,i.hasUnfixableIssues=!0)}),r)switch(a.hasIssues=!0,i.type){case"sharing-issue-map-details":a.mapsWithIssues.push(i);break;case"sharing-issue-theme-details":a.themeWithIssue=i;break;case"sharing-issue-feature-layer-details":a.featureLayersWithIssues?.push(i);break;case"sharing-issue-portal-item-details":a.portalItemWithIssues?.push(i)}},eh=e=>{let{issueItems:s,issuesReport:t,details:a}=e,i=!1;s.forEach(e=>{let{item:s,issue:r}=e;if("sharing-access-level"===r.type&&!r.hasFix){let e=eg(s);i=!0,t.hasUnfixableIssues=!0,a.hasUnfixableIssues=!0,a.sharingLevels[r.currentSharingLevel.access]=!0,e&&a.layerNames.push(e)}}),i&&(t.hasIssues=!0,t.mapsWithIssues.push(a))},ex=e=>{let{issueItems:s,issuesReport:t,details:a}=e,i=!1;s.forEach(e=>{let{item:s,issue:r}=e;if("secured-map-layer"===r.type){let e=eg(s);i=!0,t.hasUnfixableIssues=!0,a.hasUnfixableIssues=!0,e&&a.layerNames.push(e)}}),i&&(t.hasIssues=!0,t.mapsWithIssues.push(a))},ey=e=>{let{issueItems:s,issuesReport:t,details:a}=e,i=!1;s.forEach(e=>{let{item:s,issue:r}=e;"app-proxy-required"===r.type&&r.isPremiumContent&&(i=!0,r.hasFix||(t.hasUnfixableIssues=!0,a.hasUnfixableIssues=!0))}),i&&(t.hasIssues=!0,t.mapsWithIssues.push(a))},eb=(e,s)=>{let t={hasIssues:!1,hasUnfixableIssues:!1,mapsWithIssues:[],featureLayersWithIssues:[],themeWithIssue:void 0,portalItemWithIssues:[]},a={hasIssues:!1,hasUnfixableIssues:!1,mapsWithIssues:[]},i={hasIssues:!1,hasUnfixableIssues:!1,mapsWithIssues:[]},r={hasIssues:!1,hasUnfixableIssues:!1,mapsWithIssues:[]},l=[],o=e.fixOptions.authManager,n=s.PORTAL_HOST,p=e=>{let{item:s,summary:p}=e;if(l.includes(s.itemId))return;l.push(s.itemId);let u={hasUnfixableIssues:!1,itemId:s.itemId,title:s.itemInfo.itemDetails.title,thumbnailUrl:(0,C.Sg)({portalHost:n,itemDetails:s.itemInfo.itemDetails,fallbackUrl:"",authManager:o,size:100}),layerNames:[]},d={...u,type:"sharing-issue-map-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.map",pluralPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.item.layoutCount.plural",sharingLevels:{private:!1,org:!1,public:!1,shared:!1}},c={...u,type:"sharing-issue-map-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.map",pluralPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.item.layoutCount.plural",sharingLevels:{private:!1,org:!1,public:!1,shared:!1}},m={type:"premium-issue-map-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.premium.item.layoutCount.singular",pluralPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.premium.item.layoutCount.plural",...u},g={type:"secured-layers-map-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.layoutCount.singular",pluralPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.premium.unfixableSecureContent.layoutCount.plural",...u},{fixableIssues:f,unfixableIssues:h}=p,x=[...f,...h];ef({issueItems:x,issuesReport:t,details:d}),eh({issueItems:x,issuesReport:a,details:c}),ex({issueItems:x,issuesReport:i,details:g}),ey({issueItems:x,issuesReport:r,details:m})},u=e=>{let{item:s,issues:a}=e;ef({issueItems:a,issuesReport:t,details:{hasUnfixableIssues:!1,itemId:s.itemId,title:s.itemInfo.itemDetails.title,thumbnailUrl:(0,C.Sg)({portalHost:n,itemDetails:s.itemInfo.itemDetails,fallbackUrl:"",authManager:o,size:100}),type:"sharing-issue-theme-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.theme",sharingLevels:{private:!1,org:!1,public:!1,shared:!1}}})},d=e=>{let{item:s,summary:a}=e,i={hasUnfixableIssues:!1,itemId:s.itemId,title:s.itemInfo.itemDetails.title,thumbnailUrl:s.itemInfo.itemDetails?(0,C.Sg)({portalHost:n,itemDetails:s.itemInfo.itemDetails,fallbackUrl:"",authManager:o,size:100}):"",type:"sharing-issue-feature-layer-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.layer",sharingLevels:{private:!1,org:!1,public:!1,shared:!1}},{fixableIssues:r,unfixableIssues:l}=a;ef({issueItems:[...r,...l],issuesReport:t,details:i})},c=e=>{let{item:s,summary:a}=e,i=s.itemInfo.itemDetails?.type;if(!("Mobile Map Package"===i||"Mobile Scene Package"===i))return;let r={hasUnfixableIssues:!1,itemId:s.itemId,title:s.itemInfo.itemDetails.title,thumbnailUrl:s.itemInfo.itemDetails?(0,C.Sg)({portalHost:n,itemDetails:s.itemInfo.itemDetails,fallbackUrl:"",authManager:o,size:100}):"",type:"sharing-issue-portal-item-details",singularPermissionStringId:"component.builderWorkflows.publishWorkflow.fixStage.sharing.permissionUpdate.item",sharingLevels:{private:!1,org:!1,public:!1,shared:!1}},{fixableIssues:l,unfixableIssues:p}=a;ef({issueItems:[...l,...p],issuesReport:t,details:r})};return e.hasIssues&&e.itemResults.success&&e.itemResults.nestedItems.forEach(e=>{if(e.success&&e.summary.hasIssues)switch(e.item.type){case g.jJ.WEBMAP:p({item:e.item,summary:e.summary});break;case g.jJ.STORYMAP_THEME:{e.nestedItems.forEach(e=>{e.success&&e.summary.hasIssues&&e.item.type===g.jJ.WEBMAP&&p({item:e.item,summary:e.summary})});let{fixableIssues:s,unfixableIssues:t}=e,a=[...s,...t];u({item:e.item,issues:a})}break;case g.jJ.MAP_LAYER:d({item:e.item,summary:e.summary});break;case g.jJ.PORTAL_ITEM:{let s=e.item.itemInfo.itemDetails.type;("Mobile Map Package"===s||"Mobile Scene Package"===s)&&c({item:e.item,summary:e.summary})}}}),{hasFailures:e.hasFailures,hasIssues:t.hasIssues||r.hasIssues||a.hasIssues||i.hasIssues,sharingIssues:t,premiumIssues:r,unfixableSharingIssues:a,securedMapIssues:i}};class eS extends l.PureComponent{componentDidMount(){this.props.storyItem.on("publishStatusUpdate",this.updatePublishStatusMessage),this.hasMountedOnceHack||(this.hasMountedOnceHack=!0,this.checkStory())}componentWillUnmount(){this.props.storyItem.off("publishStatusUpdate",this.updatePublishStatusMessage)}render(){return(0,a.jsxs)("div",{className:r().dynamic([["c255d56a02a78a21",[u.default.color.white,ec.q.zIndex]]])+" publish-workflow",children:[(0,a.jsx)(d.nj.Controller,{onClose:this.props.onClose,onFinish:this.onFinish,children:(e,s,t,i)=>(this.next=s,this.goTo=i,(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(p.ZP,{}),(0,a.jsx)(d.nj.Stage,{order:1,delay:ec.q.stageDelay,...e,children:(0,a.jsx)(R.Z,{message:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.checkStage.message"})})}),(0,a.jsx)(p.in,{children:(0,a.jsxs)("div",{className:r().dynamic([["c255d56a02a78a21",[u.default.color.white,ec.q.zIndex]]]),children:[(0,a.jsx)(d.nj.Stage,{order:2,...e,children:this.renderUnsharableIssuesReport()}),(0,a.jsx)(d.nj.Stage,{order:3,...e,children:this.renderSecuredLayersIssueReport()}),(0,a.jsx)(d.nj.Stage,{order:4,...e,children:this.renderSharingIssuesReport()}),(0,a.jsx)(d.nj.Stage,{order:5,...e,children:this.renderPremiumIssuesReport()})]})}),(0,a.jsx)(d.nj.Stage,{order:6,delay:ec.q.stageDelay,...e,children:(0,a.jsx)(R.Z,{message:(0,a.jsx)(o.Z,{...this.state.publishStatusMessage})})}),(0,a.jsx)(d.nj.Stage,{order:7,delay:ec.q.stageDelay,...e,children:(0,a.jsx)(R.Z,{message:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.shareStage.message"})})}),(0,a.jsx)(d.nj.Stage,{order:8,delay:ec.q.stageDelay,onStageReady:this.next,...e,children:(0,a.jsx)(em.Z,{message:(0,a.jsx)(l.Fragment,{children:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.publishWorkflow.finishedPublishedStage.${this.props.mode}`})})})})]}))}),(0,a.jsx)(r(),{id:"c255d56a02a78a21",dynamic:[u.default.color.white,ec.q.zIndex],children:`.publish-workflow.__jsx-style-dynamic-selector{position:fixed;height:100vh;width:100vw;top:0;right:0;background-color:${u.default.color.white};z-index:${ec.q.zIndex}}`})]})}constructor(...e){super(...e),this.hasMountedOnceHack=!1,this.state={publishStatusMessage:{id:"component.builderWorkflows.publishWorkflow.publishStage.message"}},this.fixSharingIssues=!1,this.fixPremiumIssues=!1,this.renderUnsharableIssuesReport=()=>this.issueReport?.unfixableSharingIssues.mapsWithIssues.length>0?(0,a.jsx)(ed,{issueReport:this.issueReport.unfixableSharingIssues,storyShareToLevel:this.props.storyItem.itemSharingLevel,type:"sharing",itemType:this.props.itemType,onClose:this.props.onClose,onConfirmFix:this.unsharableFixConfirm}):null,this.renderSecuredLayersIssueReport=()=>this.issueReport?.securedMapIssues.mapsWithIssues.length>0?(0,a.jsx)(ed,{issueReport:this.issueReport.securedMapIssues,storyShareToLevel:this.props.storyItem.itemSharingLevel,type:"secured-layer",itemType:this.props.itemType,onClose:this.props.onClose,onConfirmFix:this.securedLayersFixConfirm}):null,this.renderSharingIssuesReport=()=>this.issueReport?.sharingIssues.mapsWithIssues.length>0||this.issueReport?.sharingIssues.themeWithIssue||this.issueReport?.sharingIssues.featureLayersWithIssues.length>0||this.issueReport?.sharingIssues.portalItemWithIssues.length>0?(0,a.jsx)(el,{issueReport:this.issueReport.sharingIssues,storyShareToLevel:this.props.storyItem.itemSharingLevel,type:"sharing",onClose:this.props.onClose,itemType:this.props.itemType,onConfirmFix:this.sharingFixConfirm,onSkipFix:this.sharingSkipFix}):null,this.renderPremiumIssuesReport=()=>this.issueReport&&this.issueReport.premiumIssues.mapsWithIssues.length>0?(0,a.jsx)(el,{issueReport:this.issueReport.premiumIssues,storyShareToLevel:this.props.storyItem.itemSharingLevel,type:"premium",itemType:this.props.itemType,onClose:this.props.onClose,onConfirmFix:this.premiumFixConfirm,onSkipFix:this.premiumSkipFix}):null,this.checkStory=async()=>{try{await this.props.storyItem.confirmDataLossBeforeSave(),this.checkResponse=await (0,m.B)({item:{type:this.props.itemType===Z.o.Theme?g.jJ.STORYMAP_THEME:g.jJ.STORY_MAP,itemId:this.props.storyItem.itemId,checkDraftData:"publishing"===this.props.mode},portalHost:this.props.config.PORTAL_HOST,rules:{sharing:{allowSharingToUpdateGroups:!0,requiredSharingLevel:this.props.storyItem.itemSharingLevel,...this.props.itemType!==Z.o.Theme?{appProxy:{isAppAdmin:(0,C.A7)(this.props.storyItem.itemDetails,this.props.storyItem.authManager),itemId:this.props.storyItem.itemId,registerAppParams:{appType:"multiple",redirect_uris:[window.location.origin]},serviceProxyParams:{referrers:[this.props.storyRouting.getUrlFromRouteDef((0,_.kN)({route:"viewer",itemId:this.props.storyItem.itemId,itemType:this.props.itemType,isTemplate:this.props.storyItem.isTemplate}))]}}}:{}}},authManager:this.props.storyItem.authManager,storyMapUserPrivileges:this.props.storyItem.storyMapUserPrivileges}),this.issueReport=eb(this.checkResponse,this.props.config),this.issueReport.hasFailures&&"theme"!==this.props.itemType&&this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:"component.builderWorkflows.publishWorkflow.error.failuresWhileChecking"})}),this.issueReport.hasIssues?this.goToNextStage(2):this.fixStory()}catch(e){if(e instanceof Error&&e.message===T.J8){this.props.onClose();return}this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.publishWorkflow.${this.props.itemType}.error.publishErrorDetails`})}),this.props.onClose()}},this.sharingFixConfirm=()=>{this.fixSharingIssues=!0,this.goToNextStage(5)||this.fixStory()},this.sharingSkipFix=()=>{this.fixSharingIssues=!1,this.goToNextStage(5)||this.publishStory()},this.premiumFixConfirm=()=>{this.fixPremiumIssues=!0,this.fixStory()},this.premiumSkipFix=()=>{this.fixPremiumIssues=!1,this.fixStory()},this.unsharableFixConfirm=()=>{this.fixSharingIssues=!1,this.goToNextStage(3)||this.goToPublishAndSharing()},this.securedLayersFixConfirm=()=>{this.goToNextStage(4)||this.goToPublishAndSharing()},this.fixStory=async()=>{if(this.checkResponse){let e=this.checkResponse.fixableIssues.filter(e=>"sharing-access-level"===e.issue.type&&!!this.fixSharingIssues||"app-proxy-required"===e.issue.type&&!!e.issue.isSubscriberContent||"app-proxy-required"===e.issue.type&&!!e.issue.isPremiumContent&&!!this.fixPremiumIssues);try{(await L(e,this.checkResponse.fixOptions)).forEach(e=>{if("rejected"===e.status)throw Error("Fix failed")})}catch{this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.publishWorkflow.${this.props.itemType}.error.publishFixErrorDetails`})})}}this.goToPublishAndSharing()},this.publishStory=async(e,s)=>{s||this.goTo(6);try{await this.props.storyItem.publishStory(),await this.invalidateCache(),this.goTo(8)}catch(e){this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.publishWorkflow.${this.props.itemType}.error.publishErrorDetails`})}),this.props.onClose()}},this.shareStory=async(e,s)=>{s||this.goTo(7);try{await this.props.storyItem.shareStory(),await this.invalidateCache(),this.goTo(8)}catch{this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.publishWorkflow.${this.props.itemType}.error.shareErrorDetails`})}),this.props.onClose()}},this.invalidateCache=async()=>{if(this.props.itemType!==Z.o.Theme){let e=this.props.storyRouting.getUrlFromRouteDef({route:"invalidate-gemini-item-cache",itemId:this.props.storyItem.itemId,itemType:this.props.itemType});e&&await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`token=${this.props.storyItem.authManager.token}`})}},this.updatePublishStatusMessage=e=>this.setState({publishStatusMessage:e}),this.onFinish=()=>{this.props.onFinish(!1)},this.goToNextStage=e=>(this.issueReport.unfixableSharingIssues.hasIssues||this.issueReport.unfixableSharingIssues.mapsWithIssues.length>0||this.issueReport.unfixableSharingIssues.hasUnfixableIssues)&&e<=2?(this.goTo(2),!0):(this.issueReport.securedMapIssues.hasIssues||this.issueReport.securedMapIssues.mapsWithIssues.length>0||this.issueReport.securedMapIssues.hasUnfixableIssues)&&e<=3?(this.goTo(3),!0):(this.issueReport.sharingIssues.hasIssues||this.issueReport.sharingIssues.mapsWithIssues.length>0||this.issueReport.sharingIssues.hasUnfixableIssues)&&e<=4?(this.goTo(4),!0):(!!this.issueReport.premiumIssues.hasIssues||this.issueReport.premiumIssues.mapsWithIssues.length>0||!!this.issueReport.premiumIssues.hasUnfixableIssues)&&e<=5&&(this.goTo(5),!0),this.goToPublishAndSharing=()=>{"publishing"===this.props.mode?(this.goTo(6),this.publishStory(void 0,!0)):(this.goTo(7),this.shareStory(void 0,!0))}}}var ew=(0,_.Jy)((0,c.ZP)((0,v.Df)((0,n.ZP)(eS))))},422721:function(e,s,t){var a=t(552322),i=t(742951),r=t.n(i),l=t(202784),o=t(342670),n=t(819233),p=t(788028),u=t(889322),d=t(362851),c=t(293786),m=t(863982),g=t(567523),f=t(183351),h=t(923466),x=t(528304);class y extends l.PureComponent{async componentDidMount(){try{await this.props.storyItem.confirmDataLossBeforeSave(),await this.props.storyItem.unpublishStory(),await this.invalidateCache(),this.next()}catch(e){if(e instanceof Error&&e.message===m.J8){this.props.onClose();return}this.props.toast.add({type:"error",title:(0,a.jsx)(o.Z,{id:"builder.common.sorry"}),details:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.unpublish.${this.props.itemType}.error.message`})}),this.props.onClose()}}render(){return(0,a.jsxs)("div",{className:r().dynamic([["f0182559745e3b01",[p.default.color.white,h.q.zIndex]]])+" unpublished-workflow",children:[(0,a.jsx)(u.nj.Controller,{onFinish:this.props.onFinish,children:(e,s)=>(this.next=s,(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(n.ZP,{}),(0,a.jsx)(u.nj.Stage,{order:1,delay:h.q.stageDelay,...e,children:(0,a.jsx)(f.Z,{message:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.unpublish.unpublishing.${this.props.itemType}.message`})})}),(0,a.jsx)(u.nj.Stage,{order:2,delay:h.q.stageDelay,onStageReady:this.next,...e,children:(0,a.jsx)(x.Z,{message:(0,a.jsx)(o.Z,{id:`component.builderWorkflows.unpublish.success.${this.props.itemType}.message`})})})]}))}),(0,a.jsx)(r(),{id:"f0182559745e3b01",dynamic:[p.default.color.white,h.q.zIndex],children:`.unpublished-workflow.__jsx-style-dynamic-selector{position:fixed;height:100vh;width:100vw;top:0;right:0;background-color:${p.default.color.white};z-index:${h.q.zIndex}}`})]})}constructor(...e){super(...e),this.invalidateCache=async()=>{if(this.props.itemType!==c.o.Theme){let e=this.props.storyRouting.getUrlFromRouteDef({route:"invalidate-gemini-item-cache",itemId:this.props.storyItem.itemId,itemType:this.props.itemType});e&&await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`token=${this.props.storyItem.authManager.token}`})}}}}s.Z=(0,g.Jy)((0,d.ZP)(y))},994812:function(e,s,t){var a=t(552322),i=t(742951),r=t.n(i);t(202784);var l=t(344159),o=t(788028),n=t(850358),p=t(537905),u=t(627012);s.Z=e=>{let s=e.itemSubtype??e.itemType,{BASE_URL:t}=(0,n.ZR)(),i=(0,p.Z)()((0,u.F)(s)),d=(0,u.C)({baseUrl:t,itemType:s});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.Z,{tooltipContent:i,placement:"top",children:(0,a.jsxs)("div",{className:r().dynamic([["7d229eb6b2547258",[o.default.spacing.xxxxs]]])+" item-type",children:[(0,a.jsx)("img",{src:d,alt:i,loading:"lazy",className:r().dynamic([["7d229eb6b2547258",[o.default.spacing.xxxxs]]])}),(0,a.jsx)(r(),{id:"7d229eb6b2547258",dynamic:[o.default.spacing.xxxxs],children:`.item-type.__jsx-style-dynamic-selector{padding-top:${o.default.spacing.xxxxs}}`})]})})})}},627012:function(e,s,t){t.d(s,{C:function(){return l},F:function(){return n}});var a=t(96606),i=t(798396),r=t(447878);let l=e=>{let{baseUrl:s,itemType:t}=e,l=(0,a.V9)({...i.dq,StoryMap:r.Cs,StoryMapTheme:r.j3,Briefing:i.zC.Briefing,Collection:i.zC.Collection},t);return`${s}/static/storymaps-builder/images/item-browser/item-types/${l}.svg`},o={StoryMap:"builder.common.itemType.StoryMap","SMX Item":"builder.common.itemType.StoryMap","StoryMap Theme":"common.theme","SMX Theme":"common.theme",[i.zC.Briefing]:"builder.common.itemType.Briefing",[i.zC.Collection]:"common.collection",[i.zC.Frame]:"common.frame",[i.dq.Survey123]:"builder.common.itemType.Survey123",[i.dq.WebApp]:"builder.common.itemType.WebApp",[i.dq.Dashboard]:"builder.common.itemType.Dashboard",[i.dq.HubSiteApp]:"builder.common.itemType.HubSiteApp",[i.dq.EnterpriseSiteApp]:"builder.common.itemType.EnterpriseSiteApp",[i.dq.InsightsPage]:"builder.common.itemType.InsightsPage",[i.dq.WebExperience]:"builder.common.itemType.WebExperience",[i.dq.PDF]:"builder.common.itemType.PDF",[i.dq.Image]:"builder.common.itemType.Image",[i.dq.WebMap]:"builder.common.itemType.WebMap",[i.dq.WebScene]:"builder.common.itemType.WebScene",[i.dq.MobileMapPackage]:"builder.offline.media.mapPackage",[i.dq.MobileScenePackage]:"builder.offline.media.scenePackage",[i.dq.FeatureLayer]:"builder.common.itemType.FeatureLayer"},n=e=>o[e]},292963:function(e,s,t){t.d(s,{e:function(){return r},k:function(){return i}});var a=t(202784);let i=(0,a.createContext)({toggleDesignPanelHook:()=>{},updateStoryContext:()=>{},storyLogo:{src:"https://example.org/logo.png",link:"https://example.org",alt:"alt",shouldShowLogoInHeader:!0,shouldShowLogoOnCover:!1}}),r=()=>(0,a.useContext)(i)},150459:function(e,s,t){t.d(s,{b:function(){return l}});var a=t(552322),i=t(202784),r=t(292963);let l=e=>{let[s,t]=(0,i.useState)({});return(0,a.jsx)(r.k.Provider,{value:{...s,updateStoryContext:e=>{t(s=>({...s,...e}))}},children:e.children})}},164334:function(e,s,t){var a=t(202784);class i extends a.PureComponent{render(){return!1}componentDidMount(){"undefined"!=typeof document&&document.addEventListener("keydown",this.onKeyDownHandler)}componentWillUnmount(){"undefined"!=typeof document&&document.removeEventListener("keydown",this.onKeyDownHandler)}constructor(...e){super(...e),this.onKeyDownHandler=e=>{"Backspace"!==e.key||this.isInAllowList(e.target)||e.preventDefault()},this.isInAllowList=e=>{let s=e.nodeName.toLowerCase();return"input"===s||"textarea"===s||"true"===e.contentEditable}}}s.Z=i},445481:function(e,s,t){t.d(s,{M:function(){return r}});var a=t(552322);t(202784);var i=t(686985);class r extends i.J{constructor(e){super(e,{iconName:"premium-content",path:"",viewBox:"0 0 15 16",children:()=>(0,a.jsxs)("g",{children:[(0,a.jsx)("path",{d:"M6.99666362 16c-.0938668 0-.18609791-.0245145-.26731062-.0714706C-.96919289 11.4932833.03803353 1.64038101.04872596 1.5401133c.0201949-.17274361.12354879-.32481497.2769338-.4074709.15383016-.08258738.33812807-.08616125.49505927-.0096001 1.97552219.82698005 4.25251248.43583939 5.83699472-1.00267708.199772-.16286841.48763917-.16017613.68431519.00640007 1.9428136 1.64268372 3.85034216 1.96695376 5.83485626.99414366.1564227-.07688346.3406017-.0728318.4934751.01085572.1528733.08368751.2552279.236493.274241.40941531.1393673 1.77378958.0154241 3.55838765-.3678194 5.296055-.0403014.18635167-.1771979.33709876-.3591219.39545629-.181924.05835754-.3812369.01545963-.5228596-.1125345-.1416226-.12799413-.2040391-.32163913-.1637377-.5079908.2966502-1.38847396.4283612-2.80696848.392412-4.22617722-2.0443958.71544641-4.31698391.26692093-5.93429578-1.17121216-1.67368359 1.30672147-3.87537294 1.7302833-5.91611866 1.13814515-.06094683 2.22508977.24699501 9.22782916 6.19091398 12.65079806.21067396.1202296.31372888.3669491.2509728.6008434-.06275608.2338943-.27557459.396268-.51828342.3954368z"}),(0,a.jsx)("path",{d:"M10.5 16C8.01471863 16 6 13.9852814 6 11.5 6 9.01471863 8.01471863 7 10.5 7c2.4852814 0 4.5 2.01471863 4.5 4.5-.0030992 2.4839965-2.0160035 4.4969008-4.5 4.5zm0-7.8c-1.82253967 0-3.3 1.47746033-3.3 3.3 0 1.8225397 1.47746033 3.3 3.3 3.3 1.8225397 0 3.3-1.4774603 3.3-3.3-.0018191-1.82178566-1.4782143-3.29818094-3.3-3.3z"})]})})}}},566860:function(e,s,t){t.d(s,{B:function(){return L}});var a=t(873329),i=t(348206),r=t(659882);let l=async e=>{let s={...e};if(s.rules.sharing&&s.rules.sharing.appProxy){let e=await (0,i.rV)(s.rules.sharing.appProxy.itemId,{authentication:s.authManager});s.rules.sharing.appProxy.isAppAdmin="admin"===e.itemControl,s.rules.sharing.appProxy.isRegisteredApp=(0,r.Mp)(e),s.rules.sharing.appProxy.existingAppProxy={proxies:e.appProxies?e.appProxies:[],referrers:e.serviceProxyParams&&e.serviceProxyParams.referrers?e.serviceProxyParams.referrers:[]}}return s},o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={...e};return t.isNestedItem=!0,!e.rules.sharing&&s.requiredSharingLevel&&(t.rules.sharing={requiredSharingLevel:s.requiredSharingLevel}),t},n=e=>{let s=[],t=!1,a=!1,i=[],r=[];return void 0!==e.currentItem&&(t=e.currentItem.parsedIssues.hasErrors,a=e.currentItem.parsedIssues.hasWarnings,i=e.currentItem.parsedIssues.fixableIssues.map(s=>({item:e.currentItem.item,issue:s})),r=e.currentItem.parsedIssues.unfixableIssues.map(s=>({item:e.currentItem.item,issue:s}))),e.nestedItems.forEach(e=>{e.success?(s=s.concat(e.summary.failures),i=i.concat(e.summary.fixableIssues),r=r.concat(e.summary.unfixableIssues),t=t||e.summary.hasErrors,a=a||e.summary.hasWarnings):s.push(e)}),{hasIssues:i.length>0||r.length>0,hasFailures:s.length>0,hasErrors:!!t,hasWarnings:!!a,failures:s,fixableIssues:i,unfixableIssues:r}};var p=t(69378),u=t(81052),d=t(522532),c=t(641391);let m=e=>{let s=[],t=[],a=!1,i=!1;return e.forEach(e=>{e.hasFix?s.push(e):t.push(e),"warning"===e.severity?i=!0:a=!0}),{fixableIssues:s,unfixableIssues:t,hasIssues:e.length>0,hasErrors:a,hasWarnings:i}},g=async e=>Promise.all((e.item.layers?e.item.layers:[]).reduce((s,t)=>{let i=t.itemId??t.layerItemId,r=f({...e,item:{type:a.jJ.MAP_LAYER,layerType:t.layerType,itemId:i,layers:t.layers,itemInfo:{mapLayerData:t}}});return s.concat(r)},[])),f=async e=>{try{let s,t;let a=[],l=e.item.itemInfo||{},f=!1;if(e.item.itemId){let[l]=await Promise.all([(0,i.rV)(e.item.itemId,{authentication:e.authManager})]);t=l;let o=await (0,r.kW)(l,e);o.hasIssue&&a.push(o.issue),s=o.sharingLevel,f=o.isPremiumContent||o.isSubscriberContent}if(!f&&e.item.itemInfo?.mapLayerData?.url)try{let s=await (0,p.WY)(`${(0,u.Zl)(e.portalHost,e.authManager)}/portals/checkurl`,{authentication:e.authManager,params:{url:(0,d.Cn)(e.item.itemInfo.mapLayerData.url,{f:"json"})}});!0===s.secured&&a.push({type:"secured-map-layer",severity:e.rules.sharing?.requiredSharingLevel.access===c.eJ.PUBLIC?"error":"warning",hasFix:!1})}catch{}let h=o(e,{requiredSharingLevel:s}),x=await g(h),y={...e.item,itemInfo:{...l,itemDetails:t}},b=m(a),S=n({currentItem:{item:y,parsedIssues:b},nestedItems:x});return{success:!0,item:y,...b,nestedItems:x,summary:S}}catch(s){return{success:!1,item:e.item,failure:s}}};var h=t(368667);let x=async e=>{try{let s=[],t=await (0,i.rV)(e.item.itemId,{authentication:e.authManager}),a=await (0,r.kW)(t,e);a.hasIssue&&s.push(a.issue);let l={...e.item,itemInfo:{itemDetails:t}},o=m(s),p=n({currentItem:{item:l,parsedIssues:o},nestedItems:[]});return{success:!0,item:l,...o,nestedItems:[],summary:p}}catch(s){return{success:!1,item:e.item,failure:s}}},y=(e,s)=>Promise.all(e.reduce((e,t)=>{let i=f({...s,item:{type:a.jJ.MAP_LAYER,layerType:t.layerType,itemId:t.itemId,layers:t.layers,itemInfo:{mapLayerData:t}}});return e.concat(i)},[])),b=async e=>{try{let s=[],[t,a]=await Promise.all([(0,i.rV)(e.item.itemId,{authentication:e.authManager}),(0,i.m_)(e.item.itemId,{authentication:e.authManager})]),l=await (0,r.kW)(t,e);l.hasIssue&&s.push(l.issue);let p=[...a.baseMap.baseMapLayers,...a.operationalLayers],u=o(e,{requiredSharingLevel:l.sharingLevel}),d=await y(p,u),c={...e.item,itemInfo:{itemDetails:t,itemData:a}},g=m(s),f=n({currentItem:{item:c,parsedIssues:g},nestedItems:d});return{success:!0,item:c,...g,nestedItems:d,summary:f}}catch(s){return{success:!1,item:e.item,failure:s}}},S=async(e,s)=>e.resources?await Promise.all(Object.values(e.resources).reduce((e,t)=>{if("webmap"===t.type){let i=b({...s,item:{type:a.jJ.WEBMAP,itemId:t.data.itemId}});return e.concat(i)}return e},[])):[],w=async e=>{try{let s=[],t=await (0,i.rV)(e.item.itemId,{authentication:e.authManager}),a=await (0,r.Nx)(t,e),l=await (0,r.kW)(t,e);l.hasIssue&&s.push(l.issue);let p=o(e,{requiredSharingLevel:l.sharingLevel}),u=e.item.skipBasemapOptionCheck?[]:await S(a,p),d={...e.item,itemInfo:{itemDetails:t,itemData:a}},c=m(s),g=n({currentItem:{item:d,parsedIssues:c},nestedItems:u});return{success:!0,item:d,...c,nestedItems:u,summary:g}}catch(s){return{success:!1,item:e.item,failure:s}}},k=(e,s)=>Promise.all(e.reduce((e,t)=>{let i=f({...s,item:{type:a.jJ.MAP_LAYER,layerType:t.layerType,itemId:t.itemId,layers:t.layers,itemInfo:{mapLayerData:t}}});return e.concat(i)},[])),I=async e=>{try{let s=[],[t,a]=await Promise.all([(0,i.rV)(e.item.itemId,{authentication:e.authManager}),(0,i.m_)(e.item.itemId,{authentication:e.authManager})]),l=await (0,r.kW)(t,e);l.hasIssue&&s.push(l.issue);let p=a.ground&&a.ground.layers?a.ground.layers:[],u=a.baseMap.elevationLayers?a.baseMap.elevationLayers:[],d=[...a.baseMap.baseMapLayers,...a.operationalLayers,...p,...u],c=o(e,{requiredSharingLevel:l.sharingLevel}),g=await k(d,c),f={...e.item,itemInfo:{itemDetails:t,itemData:a}},h=m(s),x=n({currentItem:{item:f,parsedIssues:h},nestedItems:g});return{success:!0,item:f,...h,nestedItems:g,summary:x}}catch(s){return{success:!1,item:e.item,failure:s}}},P=async(e,s)=>{let t;if(!("resources"in e))return[];let i=!0,r=await Promise.all(Object.keys(e.resources).reduce((i,r)=>{let l=e.resources[r];switch(l.type){case"webmap":{let e=b({...s,item:{type:a.jJ.WEBMAP,itemId:l.data.itemId}});return i.concat(e)}case"webscene":{let e=I({...s,item:{type:a.jJ.WEBSCENE,itemId:l.data.itemId}});return i.concat(e)}case"expressmap":{let e=W(s,l);return i.concat(e)}case"feature-layer":{let e=f({...s,item:{type:a.jJ.MAP_LAYER,itemId:l.data.itemId}});return i.concat(e)}case"story-theme":return t=l.data.themeItemId,i;case"portal-item":if("Mobile Scene Package"===l.data.itemType||"Mobile Map Package"===l.data.itemType){let e=x({...s,item:{type:a.jJ.PORTAL_ITEM,itemId:l.data.itemId}});return i.concat(e)}return i;default:return i}},[]));if(t){(i=!r.find(e=>"theme-basemap-used"===e))&&"nodes"in e&&(i=Object.keys(e.nodes).every(s=>{let t=e.nodes;return"tour-map"!==t[s].type||t[s].data.basemap&&"primary"!==t[s].data.basemap.value}));let l=await w({...s,item:{type:a.jJ.STORYMAP_THEME,itemId:t,skipBasemapOptionCheck:i}});await r.push(l)}return r.filter(e=>!!e&&"theme-basemap-used"!==e)},W=async(e,s)=>{let t=s.data.itemId,i=e.item.checkDraftData?"draft":"published",{authManager:r,portalHost:l}=e,o=e.item.itemId,n=(0,h.rj)(t,i),d=`${(0,u.Zl)(l,r)}/content/items/${o}/resources/${n}`,c=await (0,p.WY)(d,{authentication:r}),m=c.basemap.type;if("order"===m)return"theme-basemap-used";if("resource"!==m)return;let g=c.basemap.value;return b({...e,item:{type:a.jJ.WEBMAP,itemId:g}})},j=async e=>{try{let s=[],t=await (0,i.rV)(e.item.itemId,{authentication:e.authManager}),a=await (0,r.Nx)(t,e),l=await (0,r.kW)(t,e);l.hasIssue&&s.push(l.issue);let p=o(e,{requiredSharingLevel:l.sharingLevel}),u=await P(a,p),d={...e.item,itemInfo:{itemDetails:t,storyData:a}},c=m(s),g=n({currentItem:{item:d,parsedIssues:c},nestedItems:u});return{success:!0,item:d,...c,nestedItems:u,summary:g}}catch(s){return{success:!1,item:e.item,failure:s}}},L=async e=>{let s;let t=await l(e);switch(t.item.type){case a.jJ.STORY_MAP:s=await j(t);break;case a.jJ.WEBMAP:s=await b(t);break;case a.jJ.WEBSCENE:s=await I(t);break;case a.jJ.MAP_LAYER:s=await f(t);break;case a.jJ.STORYMAP_THEME:s=await w(t);break;default:s={success:!1,item:e.item,failure:Error(`The type "${t.item.type}" is not a valid type.`)}}let{item:i,...r}=t;return{...n({nestedItems:[s]}),itemResults:s,fixOptions:r}}},873329:function(e,s,t){var a,i,r,l;t.d(s,{Im:function(){return p},Yn:function(){return o},eW:function(){return n},jJ:function(){return a}}),(r=a||(a={})).STORY_MAP="storymap",r.WEBMAP="webmap",r.WEBSCENE="webscene",r.MAP_LAYER="map-layer",r.PORTAL_ITEM="portal-item",r.STORYMAP_THEME="storymap-theme",(l=i||(i={})).ARCGIS_STREAM_LAYER="ArcGISStreamLayer",l.BING_AERIAL_LAYER="BingMapsAerial",l.BING_ROAD_LAYER="BingMapsRoad",l.BING_HYBRID_LAYER="BingMapsHybrid",l.BUILDING_SCENE_LAYER="BuildingSceneLayer",l.CATALOG_LAYER="CatalogLayer",l.CSV_LAYER="CSV",l.ELEVATION_LAYER="ArcGISTiledElevationServiceLayer",l.FEATURE_LAYER="ArcGISFeatureLayer",l.GEO_JSON_LAYER="GeoJSON",l.GEO_RSS_LAYER="GeoRSS",l.GROUP_LAYER="GroupLayer",l.IMAGE_SERVICE_LAYER="ArcGISImageServiceLayer",l.IMAGE_SERVICE_VECTOR_LAYER="ArcGISImageServiceVectorLayer",l.INTEGRATED_MESH_LAYER="IntegratedMeshLayer",l.KML_LAYER="KML",l.MAP_SERVICE_LAYER="ArcGISMapServiceLayer",l.OGC_FEATURE_LAYER="OGCFeatureLayer",l.OPEN_STREET_MAP_LAYER="OpenStreetMap",l.POINT_CLOUD_LAYER="PointCloudLayer",l.SCENE_LAYER="ArcGISSceneServiceLayer",l.SUB_TYPE_GROUP_LAYER="SubtypeGroupLayer",l.TILED_IMAGE_SERVICE_LAYER="ArcGISTiledImageServiceLayer",l.TILED_MAP_SERVICE_LAYER="ArcGISTiledMapServiceLayer",l.VECTOR_TILE_LAYER="VectorTileLayer",l.WEB_FEATURE_SERVICE_LAYER="WFS",l.WEB_TILE_LAYER="WebTiledLayer",l.WMS_LAYER="WMS";let o=Error("The issue cannot be automatically fixed"),n=Error("App cannot be registered. Registration must be provided"),p=Error("No app proxy information provided")},659882:function(e,s,t){t.d(s,{Mp:function(){return y},Nx:function(){return b},XM:function(){return m},kW:function(){return x},pA:function(){return g}});var a=t(348206),i=t(641391),r=t(368667),l=t(180997),o=t(844407),n=t(974712),p=t(873329);let u=async e=>{if(!e.requiredSharingLevel.groups||0===e.requiredSharingLevel.groups.length||e.isNestedItem&&(e.itemDetails.access===i.eJ.PUBLIC||e.requiredSharingLevel.access===i.eJ.PUBLIC))return!1;let s=await (0,r.mY)({itemDetails:e.itemDetails,authManager:e.authManager}),t=e.requiredSharingLevel.groups.filter(e=>!s.includes(e));return 0!==t.length&&t},d=(e,s)=>{let t=[i.eJ.PRIVATE,i.eJ.SHARED,i.eJ.ORG,i.eJ.PUBLIC];return t.indexOf(s.access)>=t.indexOf(e)},c=async e=>{let s=(0,r.A7)(e.itemDetails,e.authManager);if(!d(e.requiredSharingLevel.access,e.itemDetails)&&!s)return!1;let t=await e.authManager.getUser();if(e.requiredSharingLevel.access===i.eJ.ORG&&(e.storyMapUserPrivileges&&!e.storyMapUserPrivileges.canShareOrg||!e.storyMapUserPrivileges&&t.privileges&&0>t.privileges.indexOf("portal:user:shareToOrg")&&0>t.privileges.indexOf("portal:admin:shareToOrg"))||e.requiredSharingLevel.access===i.eJ.PUBLIC&&(e.storyMapUserPrivileges&&!e.storyMapUserPrivileges.canSharePublic||!e.storyMapUserPrivileges&&t.privileges&&0>t.privileges.indexOf("portal:user:shareToPublic")&&0>t.privileges.indexOf("portal:admin:shareToPublic"))||e.requiredSharingLevel.groups&&e.requiredSharingLevel.groups.length>0&&(e.storyMapUserPrivileges&&!e.storyMapUserPrivileges.canShareToGroup||!e.storyMapUserPrivileges&&t.privileges&&0>t.privileges.indexOf("portal:user:shareToGroup")&&0>t.privileges.indexOf("portal:admin:shareToGroup")))return!1;if(e.newRequiredGroups)for(let a of e.newRequiredGroups){let i=t.groups?.find(e=>e.id===a);if(!i||!(0,l.Q)({group:i,hasItemOwnerPermission:s,allowSharingToUpdateGroups:e.allowSharingToUpdateGroups}))return!1}return!0},m=e=>(e.typeKeywords??[]).indexOf("Requires Credits")>=0,g=e=>(e.typeKeywords??[]).indexOf("Requires Subscription")>=0,f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let s=new URL(e);return s.origin+s.pathname.replace(/\/\d*$/,"")}catch{return e}},h=(e,s)=>{try{let t=s.rules.sharing.appProxy.existingAppProxy.proxies.filter(s=>e===s.sourceUrl).length>0,a=s.rules.sharing.appProxy.serviceProxyParams.referrers.filter(e=>!s.rules.sharing.appProxy.existingAppProxy.referrers.includes(e)).length>0;return t&&!a}catch{return!1}},x=async(e,s)=>{let t={access:e.access},r=s.rules.sharing?.requiredSharingLevel?s.rules.sharing.requiredSharingLevel:{access:e.access},l=m(e),o=g(e);if(s.item.type===p.jJ.MAP_LAYER&&r.access===i.eJ.PUBLIC){let a=f(e.url);if((l||o)&&!h(a,s)){let e={hasIssue:!0,sharingLevel:t,isPremiumContent:l,isSubscriberContent:o,issue:{type:"app-proxy-required",hasFix:!!s.rules.sharing&&!!s.rules.sharing.appProxy&&!!s.rules.sharing.appProxy.isAppAdmin&&(!!s.rules.sharing.appProxy.isRegisteredApp||!s.rules.sharing.appProxy.isRegisteredApp&&!!s.rules.sharing.appProxy.registerAppParams&&s.rules.sharing.appProxy.registerAppParams.redirect_uris.length>0),severity:"error",isPremiumContent:l,isSubscriberContent:o}};return e.issue.hasFix&&(e.issue.fix={type:"app-proxy",sourceUrl:a}),e}}let n=d(r.access,e),x=await u({isNestedItem:!!s.isNestedItem,itemDetails:e,requiredSharingLevel:r,authManager:s.authManager});if(!n||x){let p=await c({itemDetails:e,requiredSharingLevel:r,newRequiredGroups:x,authManager:s.authManager,storyMapUserPrivileges:s.storyMapUserPrivileges,allowSharingToUpdateGroups:s.rules.sharing?.allowSharingToUpdateGroups}),u={hasIssue:!0,sharingLevel:t,isPremiumContent:l,isSubscriberContent:o,issue:{type:"sharing-access-level",severity:"error",requiredSharingLevel:r,currentSharingLevel:t,hasFix:p}};return p&&(u.issue.fix=async()=>{let t=[];return n||t.push((0,a.zT)({authentication:s.authManager,id:e.id,access:r.access===i.eJ.SHARED?i.eJ.PRIVATE:r.access,owner:e.owner})),!1!==x&&x.forEach(i=>{t.push((0,a.Ju)({id:e.id,groupId:i,confirmItemControl:s.rules.sharing?.allowSharingToUpdateGroups,authentication:s.authManager,owner:e.owner}))}),await Promise.all(t)}),u}return{hasIssue:!1,sharingLevel:t,isPremiumContent:l,isSubscriberContent:o}},y=e=>e.typeKeywords&&e.typeKeywords.includes("Registered App"),b=(e,s)=>s.item.checkDraftData?(0,o.jH)({itemDetails:e,portalHost:s.portalHost,authManager:s.authManager}):(0,n.L)({itemId:s.item.itemId,authManager:s.authManager,portalHost:s.portalHost})},497872:function(e,s,t){t.d(s,{J:function(){return a}});let a=e=>"string"==typeof e&&/^[a-zA-Z\d]{32}$/g.test(e)},705548:function(e,s,t){t.d(s,{z:function(){return a}});let a=(e,s,t)=>t.indexOf(e)===s},644865:function(e,s,t){var a=t(552322),i=t(742951),r=t.n(i),l=t(202784),o=t(342670),n=t(294185),p=t(289274),u=t(69993),d=t(923466),c=t(307411),m=t(560475),g=t(558001),f=t(788028),h=t(53384),x=t(398804),y=t(850358),b=t(904845);class S extends l.PureComponent{componentDidMount(){this.props.storyItem.setConfirmDataLossMethod(this.confirmDataLossMethod),this.props.storyItem.on("DATA_OVERWRITE_REJECTED",this.onDataOverwriteRejected)}render(){let e=this.state.editInfo?.editor===this.state.editor?.username,s=this.state.editInfo?.modified?(0,u.W)(new Date(this.state.editInfo.modified)):void 0;return(0,a.jsxs)(m.Z,{headerTitle:this.state.isEditorCurrentUser?(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.sameAuthor.title"}):(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.title"}),isShowingModal:e&&this.state.isModalShowing,onPrimaryButtonClick:this.doNotOverwriteSavedData,primaryButtonTitle:(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.button.exitBuilder"}),onSecondaryButtonClick:this.overwriteSavedData,secondaryButtonTitle:this.state.isEditorCurrentUser?(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.button.keepEditing"}):(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.button.editAnyway"}),onCloseButtonClick:this.state.isEditorCurrentUser?this.overwriteSavedData:void 0,closeButtonLabel:this.props.intl.formatMessage({id:"common.close"}),portalClassNames:`multi-author-data-loss-modal-portal ${this.modalStyles.className}`,children:[e&&(this.state.isEditorCurrentUser?(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.sameAuthor.description",tagName:"p"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:r().dynamic([["19ae611c179f903c",[g.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),f.default.spacing.xxs,f.default.font.weight.bold]]])+" editor-details",children:[(0,a.jsx)(l.Fragment,{children:this.props.renderOtherAuthorAvatarImage?.(this.state.editor)},this.state.editor?.username),(0,a.jsxs)("div",{className:r().dynamic([["19ae611c179f903c",[g.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),f.default.spacing.xxs,f.default.font.weight.bold]]])+" end",children:[(0,a.jsx)("p",{className:r().dynamic([["19ae611c179f903c",[g.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),f.default.spacing.xxs,f.default.font.weight.bold]]])+" name",children:this.state.editor?.fullName}),s&&(0,a.jsx)(n.Z,{value:s.value,unit:s.unit,numeric:"auto"})]})]}),(0,a.jsx)(o.Z,{id:"builder.collaboration.modalWarning.description",tagName:"p"})]})),this.modalStyles.styles,(0,a.jsx)(r(),{id:"19ae611c179f903c",dynamic:[g.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xxxs,alignItems:"center",justifyContent:"start"}),f.default.spacing.xxs,f.default.font.weight.bold],children:`.editor-details.__jsx-style-dynamic-selector{${g.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xxxs,alignItems:"center",justifyContent:"start"})}
            margin-bottom: ${f.default.spacing.xxs};}.name.__jsx-style-dynamic-selector{font-weight:${f.default.font.weight.bold};line-height:1}`})]})}constructor(...e){super(...e),this.state={isModalShowing:!1},this.modalStyles={styles:(0,a.jsx)(r(),{id:"d0813b815e541",children:`.multi-author-data-loss-modal-portal.jsx-d0813b815e541{z-index:${Math.max(h.y$,d.q.zIndex)+1}}`}),className:"jsx-d0813b815e541"},this.confirmDataLossMethod=e=>new Promise(s=>{this.confirmDataLossStart(e,s)}),this.confirmDataLossStart=(e,s)=>{this.confirmDataLossResolve=s,this.getEditorProfileInfo(e),this.setState({isModalShowing:!0,editInfo:e})},this.overwriteSavedData=()=>{this.confirmDataLossEnd(!0)},this.doNotOverwriteSavedData=()=>{this.confirmDataLossEnd(!1)},this.confirmDataLossEnd=e=>{this.confirmDataLossResolve&&this.confirmDataLossResolve(e),this.setState({isModalShowing:!1})},this.onDataOverwriteRejected=()=>{let e=(0,c.N)(this.props.itemType,this.props.storyItem.isTemplate);(0,b.j)({href:`/${e}`,asPath:`${this.props.config.BASE_URL}/${e}`})},this.getEditorProfileInfo=async e=>{let s=this.state.currentUser??await this.props.storyItem.authManager.getUser();if(e.editor===s.username)this.setState({editor:s,currentUser:s,isEditorCurrentUser:!0});else{let t=await (0,x.Ke)({username:e.editor,portalHost:this.props.config.PORTAL_HOST,authManager:this.props.storyItem.authManager});this.setState({editor:t,currentUser:s,isEditorCurrentUser:!1})}}}}s.Z=(0,p.ZP)((0,y.Df)(S))},518273:function(e,s,t){t.d(s,{q:function(){return d}});var a=t(718895),i=t(96606),r=t(293786),l=t(641391),o=t(768995);class n extends Error{constructor(e){super(),this.name="WebsiteError",this.type=this.message=e;let{statusCode:s}=(0,o.P)(this.type);this.statusCode=s}}var p=t(904845),u=t(834406);let d=e=>{let s;if((0,i.F8)(u.env.DISABLE_REDIRECT_ON_LOAD_ERROR)){console.error("\uD83D\uDD34 Error occurred when loading the page. Page is not redirected because of DISABLE_REDIRECT_ON_LOAD_ERROR flag. Here’s the error, if any:",e.error);return}let{authManager:t,error:o,signInUrl:d,config:c,ctx:m}=e,g=e=>{(0,p.j)({ctx:m,asPath:`${c.BASE_URL}${e}`,href:e})};if(!o||!o.code){g("/error?errType=story-load");return}let f=e.ctx?.pathname;switch(s=f?.includes("/collections/")?r.o.Collection:f?.includes("/themes/")?r.o.Theme:r.o.Story,o.code){case l._n.ITEM_ACCESS_UNAUTHORIZED:if(t&&t.token)throw new a.Z({type:"story-inaccessible",itemType:s});(0,p.j)({ctx:m,href:d,isExternal:!0});break;case l._n.SUBSCRIPTION_CANCELED:case l._n.SUBSCRIPTION_DISABLED:case l._n.OWNER_SUBSCRIPTION_DISABLED:g("/error?errType=story-inaccessible");break;case l._n.ITEM_NONEXISTENT_OR_INACCESSIBLE:throw new a.Z({type:"story-not-found",itemType:s});case l._n.APP_BLOCKED_FOR_ORG:throw new n("blocked-org");default:{let e=o?.response?.error?.code;if(403===e)throw new a.Z({type:"story-inaccessible",itemType:s});if(400===e||404===e)throw new a.Z({type:"story-not-found",itemType:s});throw new a.Z({type:"story-load",itemType:s})}}}}}]);