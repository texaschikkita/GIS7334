"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59999,18999,98382],{387651:function(e,t,i){i.d(t,{I:function(){return s}});let s="M12 16a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1zM5 1h7v1H5zm0 2h7v9H5zm0 10h7v2H9v-1H8v1H5z"},381e3:function(e,t,i){i.d(t,{G:function(){return s}});let s="M15.167 13a.834.834 0 0 0 .833-.834V1.834A.834.834 0 0 0 15.167 1H.833A.834.834 0 0 0 0 1.833v10.334A.834.834 0 0 0 .833 13H6v1H5v1h6v-1h-1v-1zM1 2h14v10H1zm8 12H7v-1h2z"},732368:function(e,t,i){i.d(t,{M:function(){return s}});let s="M22.719 12A10.719 10.719 0 0 1 1.28 12h.838a9.916 9.916 0 1 0 1.373-5H8v1H2V2h1v4.2A10.71 10.71 0 0 1 22.719 12z"},435605:function(e,t,i){i.d(t,{$q:function(){return b},IF:function(){return m},K3:function(){return f},s7:function(){return v}});var s=i(202784),o=i(783112),a=i(614549),r=i(752179),n=i(140995),l=i(718895),p=i(504908),d=i(179463),c=i(876653),h=i(949843),u=i(517637);let m=e=>{(0,s.useEffect)(()=>{(0,a.Mq)(e)},[e])},g=e=>{let t=(0,s.useRef)();return{initialThemeItemInfo:e??t.current,setInitialThemeItemInfo:(0,s.useCallback)(e=>{t.current=e},[])}},f=e=>{let{isOrgItem:t,isEmbedded:i,headerQuery:o}=e,a=(0,d.Z)(!0),r=(0,s.useMemo)(()=>!t||(!i||"true"===o||""===o)&&"false"!==o,[t,i,o]);return!!a&&r},y=e=>{let{itemType:t,version:i,viewerMode:o,id:a,itemDetails:n,versionedItemData:l,authManager:p,storyMapUserPrivileges:d,config:c}=e,h=new r.Z({type:t,authManager:p,version:i,getStoryMapUserPrivileges:()=>d,viewerMode:o,config:c});return a&&(h.itemId=a),n&&(h.itemDetails=n),l&&(h.itemData=l),(0,s.useRef)(h).current},x=e=>{let{itemType:t,version:i,viewerMode:o,id:a,itemDetails:r,versionedItemData:l,authManager:p,storyMapUserPrivileges:d,config:c}=e,h=new n.ZP({type:t,authManager:p,version:i,getStoryMapUserPrivileges:()=>d,viewerMode:o,config:c});return a&&(h.itemId=a),r&&(h.itemDetails=r),l&&(h.itemDraftData=l),(0,s.useRef)(h).current},w=(0,c.e)(),b=(e,t)=>{let{id:i,itemDetails:o,publishedData:a,setLocaleFromPage:r,query:n,config:p,signInUrl:d,authManager:c,storyMapUserPrivileges:m}=t,[f,x]=(0,s.useState)(!w),b=y({itemType:e,version:"published",viewerMode:"view",authManager:c,storyMapUserPrivileges:m,config:p,...f?{id:i,itemDetails:o,versionedItemData:a}:{}}),{initialThemeItemInfo:v,setInitialThemeItemInfo:I}=g(t.initialThemeItemInfo);return(0,s.useEffect)(()=>{let t=!1;return(async()=>{try{if(!f){let i=await (0,h.A5)({id:n?.id,config:p,signInUrl:d,authManager:c,itemType:e,shouldRedirect:!0,convertRoute:u.Q});if(t||!i.success)return;let{id:s,itemDetails:o,publishedData:a,pageLocale:l,initialThemeItemInfo:m}=i;b.itemId=s,b.itemDetails=o,b.itemData=a,I(m),await r({pageLocale:l}),x(!0)}}catch(e){x(()=>{if(e instanceof l.Z)throw new l.Z(e);throw Error(e)})}})(),()=>{t=!0}},[b,I,f,e,r,n,p,d,c]),{isReady:f,storyItem:b,initialThemeItemInfo:v}},v=(e,t)=>{let{id:i,itemDetails:a,draftData:r,locale:n,setLocaleFromPage:d,query:c,config:m,signInUrl:f,authManager:y,storyMapUserPrivileges:b}=t,{formatMessage:v}=(0,o.Z)(),I=c?.id===p.BD||i===p.BD,[S,T]=(0,s.useState)(!(w||I)),k=x({itemType:e,version:"draft",viewerMode:"preview",authManager:y,storyMapUserPrivileges:b,config:m,...S?{id:i,itemDetails:a,versionedItemData:r}:{}}),{initialThemeItemInfo:D,setInitialThemeItemInfo:A}=g(t.initialThemeItemInfo);return(0,s.useEffect)(()=>{let t=!1;return(async()=>{try{if(!S){I&&await d({pageLocale:n});let i=await (0,h.tz)({id:c?.id,config:m,signInUrl:f,authManager:y,formatMessage:v,itemType:e,shouldRedirect:!0,convertRoute:u.Q});if(t||!i.success)return;let{id:s,itemDetails:o,draftData:a,pageLocale:r,initialThemeItemInfo:l}=i;k.itemId=s,k.itemDetails=o,k.itemDraftData=a,A(l),I||await d({pageLocale:r}),T(!0)}}catch(e){T(()=>{if(e instanceof l.Z)throw new l.Z(e);throw Error(e)})}})(),()=>{t=!0}},[k,A,S,e,n,d,c,m,f,y,I,v]),{isReady:S,storyItem:k,initialThemeItemInfo:D,mode:c?.mode||"preview"}}},89393:function(e,t,i){i.d(t,{b:function(){return r}});var s=i(718895),o=i(497872),a=i(517637);let r=e=>{let{itemType:t,dataPreparer:i,privilegesChecker:r}=e;return async(e,n)=>{let{id:l}=e.query,{authManager:p,config:d,signInUrl:c,storyMapUserPrivileges:h}=n,u=r?.(h);if(u)throw u;if("string"!=typeof l||!(0,o.J)(l))throw new s.Z({type:"story-inaccessible",itemType:t});return await i({ctx:e,id:l,config:d,authManager:p,signInUrl:c,itemType:t,shouldRedirect:!0,convertRoute:a.Q})}}},92061:function(e,t,i){i.d(t,{h:function(){return h}});var s=i(552322),o=i(742951),a=i.n(o);i(202784);var r=i(412524),n=i.n(r),l=i(663010),p=i(326860),d=i(103010),c=i(344159);let h=e=>{let t=(0,l.z$)(),i=e.trackingEventData?t.getDataAttributes(e.trackingEventData):{},o={styles:(0,s.jsx)(a(),{id:"fdb33912e95ade24",children:".media-toolbar-button.flipped.jsx-fdb33912e95ade24{-webkit-transform:scale(-1,1);-moz-transform:scale(-1,1);-ms-transform:scale(-1,1);-o-transform:scale(-1,1);transform:scale(-1,1)}"}),className:"jsx-fdb33912e95ade24"},r=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.ZP,{type:e.type??"single-icon",id:e.buttonId,onClick:e.onClick,className:n()("media-toolbar-button",o.className,{flipped:e.shouldFlip}),disabled:e.disabled,"aria-label":e.tooltipContent,...i,"aria-pressed":e["aria-pressed"]&&!e.disabled,"aria-expanded":e["aria-expanded"],"aria-haspopup":e["aria-haspopup"],onMouseLeave:e.onMouseLeave,testId:e.buttonId,children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{...e.iconProps,size:16}),e.buttonTextContent]})}),o.styles]});return(0,s.jsx)(c.Z,{tooltipContent:e.tooltipContent,onCreate:e.onCreate,children:e.renderButton?.(r)??r},e.buttonId)};t.Z=h},417209:function(e,t,i){var s=i(552322),o=i(742951),a=i.n(o),r=i(202784),n=i(412524),l=i.n(n),p=i(980860);let d=(0,r.memo)(e=>{let{isShowing:t,toggleStoryOverlay:i,isInvisible:o}=e,{backgroundColor:n}=(0,p.XL)(),[d,c]=(0,r.useState)(t);(0,r.useEffect)(()=>{t&&c(!0)},[t]);let h=async()=>{i&&(window.scrollTo(0,0),await i(!1),t||c(!1))};return(0,s.jsxs)(s.Fragment,{children:[d&&(0,s.jsx)("div",{onAnimationEnd:h,className:a().dynamic([["8caa15c645e5651",[n,o?0:1]]])+" "+(l()("story-overlay",{"fade-in":!o&&t,"fade-out":!o&&!t})||"")}),(0,s.jsx)(a(),{id:"8caa15c645e5651",dynamic:[n,o?0:1],children:`.story-overlay.__jsx-style-dynamic-selector{background-color:${n};position:fixed;width:100%;height:100%;top:0;left:0;right:0;bottom:0;z-index:2;opacity:${o?0:1};pointer-events:none}.fade-in.__jsx-style-dynamic-selector{-webkit-animation:fadeIn 250ms ease-in;-moz-animation:fadeIn 250ms ease-in;-o-animation:fadeIn 250ms ease-in;animation:fadeIn 250ms ease-in}@-webkit-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.fade-out.__jsx-style-dynamic-selector{-webkit-animation:fadeOut 250ms ease-out;-moz-animation:fadeOut 250ms ease-out;-o-animation:fadeOut 250ms ease-out;animation:fadeOut 250ms ease-out}@-webkit-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-moz-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-o-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@keyframes fadeOut{0%{opacity:1}100%{opacity:0}}`})]})});t.Z=d},590991:function(e,t,i){i.d(t,{AD:function(){return g},An:function(){return p},Cd:function(){return a},Cx:function(){return s},Kj:function(){return l},O4:function(){return c},XR:function(){return h},fS:function(){return d},jf:function(){return o},l:function(){return u},li:function(){return n},oc:function(){return m},qi:function(){return f},sk:function(){return r}});let s="item-end-reached",o="stop-scrolling-item",a="autoplay-next-item",r="toggle-item-autoplay",n="toggle-item-speed",l="reset-item",p="iframe-ready-for-communication",d="enable-item-autoplay",c="disable-item-autoplay",h="update-parent-pause",u="active-item-iframe",m=1500,g=1e3,f={slow:{displaySpeed:"1/2x",pageScrollDelay:40,collectionAutoplayDuration:12e4,briefingAutoplayDuration:6e4},medium:{displaySpeed:"1x",pageScrollDelay:20,collectionAutoplayDuration:6e4,briefingAutoplayDuration:3e4},fast:{displaySpeed:"2x",pageScrollDelay:10,collectionAutoplayDuration:3e4,briefingAutoplayDuration:15e3}}},334993:function(e,t,i){i.d(t,{Z:function(){return eY}});var s,o=i(552322),a=i(742951),r=i.n(a),n=i(202784),l=i(342670),p=i(289274),d=i(412524),c=i.n(d),h=i(97729),u=i.n(h),m=i(249490),g=i(790007),f=i(788028),y=i(578166),x=i(355125),w=i(362851),b=i(816211),v=i(210108),I=i(293786),S=i(999354),T=i(92340),k=i(820666),D=i(850358),A=i(819556),C=i(2519),j=i(558323),P=i(558001),_=i(65483),$=i(103010),L=i(537905),E=e=>{let t=(0,L.Z)(),{theme:i}=(0,g.Fj)(),s=(0,b.uw)();return(0,o.jsxs)("div",{className:r().dynamic([["19138b3a2db3c2bc",[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge]]])+" container",children:[(0,o.jsx)("h3",{className:r().dynamic([["19138b3a2db3c2bc",[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge]]])+" title",children:t("component.builderHeader.storySettings.analytics.message.title")}),(0,o.jsx)("div",{dangerouslySetInnerHTML:{__html:e.message},className:r().dynamic([["19138b3a2db3c2bc",[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge]]])+" message-container"}),(0,o.jsx)(_.Z,{primaryButtonTitle:t("component.builderHeader.storySettings.analytics.message.button.allow"),onPrimaryButtonClick:e.onAllowClicked,orientation:s.isViewportMinWidth("medium")?"horizontal":"vertical",startContent:(0,o.jsx)("h4",{className:r().dynamic([["19138b3a2db3c2bc",[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge]]])+" footer-label",children:t("component.builderHeader.storySettings.analytics.message.allowTracking")})}),(0,o.jsx)("button",{"aria-label":t("common.close"),onClick:e.onDismissClicked,className:r().dynamic([["19138b3a2db3c2bc",[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge]]])+" close-button",children:(0,o.jsx)($.Z,{path:j.n,size:16,fill:i.colors.labelPrimary})}),(0,o.jsx)(r(),{id:"19138b3a2db3c2bc",dynamic:[f.default.spacing.sm,P.ZP.shadow.sm(),P.ZP.overflowWrap(),f.default.spacing.xxs,f.default.spacing.xxs,f.default.spacing.xxs,f.default.color.white,f.default.spacing.xs,f.default.spacing.xxs,P.ZP.typography.subtitleSmall(),f.default.color.darkGreen,f.default.spacing.xxxs,f.default.spacing.xs,f.default.spacing.md,P.ZP.typography.bodySmall(),f.default.color.cadet,f.default.spacing.xs,f.default.spacing.xs,f.default.spacing.xxs,i.colors.labelLink,P.ZP.typography.bodyLarge(),f.default.spacing.xxxxs,f.default.spacing.xxxxs,f.default.spacing.xxxs,y.Kk.RTL,f.default.spacing.xxxxs,f.default.responsiveBreakpoints.large,f.default.responsiveBreakpoints.extraLarge],children:`.container.__jsx-style-dynamic-selector{--space-from-bottom:${f.default.spacing.sm};${P.ZP.shadow.sm()}
          ${P.ZP.overflowWrap()}
          position: fixed;z-index:9999;bottom:var(--space-from-bottom);left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);width:100%;max-width:-webkit-calc(100% - ${f.default.spacing.xxs} - ${f.default.spacing.xxs});max-width:-moz-calc(100% - ${f.default.spacing.xxs} - ${f.default.spacing.xxs});max-width:calc(100% - ${f.default.spacing.xxs} - ${f.default.spacing.xxs});max-height:-webkit-calc(100vh - var(--space-from-bottom) - ${f.default.spacing.xxs});max-height:-moz-calc(100vh - var(--space-from-bottom) - ${f.default.spacing.xxs});max-height:calc(100vh - var(--space-from-bottom) - ${f.default.spacing.xxs});display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:${f.default.color.white};padding:${f.default.spacing.xs} 0 ${f.default.spacing.xxs}}.title.__jsx-style-dynamic-selector{${P.ZP.typography.subtitleSmall()}
          color: ${f.default.color.darkGreen};margin-bottom:${f.default.spacing.xxxs};-webkit-padding-start:${f.default.spacing.xs};-moz-padding-start:${f.default.spacing.xs};padding-inline-start:${f.default.spacing.xs};-webkit-padding-end:${f.default.spacing.md};-moz-padding-end:${f.default.spacing.md};padding-inline-end:${f.default.spacing.md}}.message-container.__jsx-style-dynamic-selector{${P.ZP.typography.bodySmall()}
          overflow-y: auto;color:${f.default.color.cadet};-webkit-padding-start:${f.default.spacing.xs};-moz-padding-start:${f.default.spacing.xs};padding-inline-start:${f.default.spacing.xs};-webkit-padding-end:${f.default.spacing.xs};-moz-padding-end:${f.default.spacing.xs};padding-inline-end:${f.default.spacing.xs};padding-bottom:${f.default.spacing.xxs}}.message-container.__jsx-style-dynamic-selector a,.message-container.__jsx-style-dynamic-selector a:visited{color:${i.colors.labelLink}}.footer-label.__jsx-style-dynamic-selector{${P.ZP.typography.bodyLarge()}
        }.close-button.__jsx-style-dynamic-selector{position:absolute;top:${f.default.spacing.xxxxs};right:${f.default.spacing.xxxxs};padding:${f.default.spacing.xxxs};line-height:0}${y.Kk.RTL} .close-button.__jsx-style-dynamic-selector{right:unset;left:${f.default.spacing.xxxxs}}@media(min-width:${f.default.responsiveBreakpoints.large}){.container.__jsx-style-dynamic-selector{width:75%;max-width:${f.default.responsiveBreakpoints.extraLarge}}}`})]})},M=i(486693),R=i(980860),B=i(863292),Z=i(567523),O=i(340733),H=i(65032),N=i(45324),z=i(212908),U=i(544213),V=i(400983),W=i(177692),F=i(276886),K=i(725270),q=i(6921),G=i(417209),Y=i(23027),X=i(46691),J=i(732368),Q=i(201857),ee=i(326860);let et={"1/2x":"M15 23H8.1v-.5c0-2.157 1.762-3.105 3.316-3.942 1.392-.748 2.593-1.394 2.593-2.721 0-1.046-1.184-1.837-2.47-1.855a2.38 2.38 0 0 0-2.001.72A2.118 2.118 0 0 0 8.973 16h-.97a2.954 2.954 0 0 1 .823-2 3.437 3.437 0 0 1 2.727-1c1.828 0 3.438 1.245 3.438 2.837 0 1.924-1.639 2.815-3.1 3.602-1.273.685-2.482 1.335-2.74 2.561H15zM11 3.422l-.916-.4-8.077 18.57.916.4zM4 2.207L1.011 3.634l.43.903L3 3.793v8.167h1zM22.689 9L20.5 11.696 18.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L22.689 16h1.306l-2.842-3.5L23.995 9z","1x":"M9 21H8V4.743L4.804 6l-.377-.882L9 3.257zm9.689-12L16.5 11.696 14.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L18.689 16h1.306l-2.842-3.5L19.995 9z","2x":"M13 20H2.004v-.5c0-3.497 2.885-5.076 5.43-6.469 2.352-1.287 4.575-2.504 4.575-5.007a4.172 4.172 0 0 0-4.173-4.038A4.693 4.693 0 0 0 4.31 5.304a5.604 5.604 0 0 0-1.315 3.685l-.989.005A6.475 6.475 0 0 1 3.59 4.611a5.63 5.63 0 0 1 4.246-1.598A5.155 5.155 0 0 1 13 8.024c0 3.096-2.581 4.514-5.086 5.884-2.376 1.3-4.627 2.532-4.886 5.092H13zm8.689-11L19.5 11.696 17.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L21.689 16h1.306l-2.842-3.5L22.995 9z"};class ei extends n.PureComponent{constructor(e){super(e),this.setHoverState=()=>{this.state.isHovering||this.setState({isShowing:!0,isHovering:!0})},this.removeHoverState=()=>{this.state.isHovering&&this.setState({isHovering:!1})},this.state={isShowing:this.props.isShowing,isHovering:!1}}componentDidUpdate(){this.props.isShowing===this.state.isShowing||this.state.isHovering||this.setState({isShowing:this.props.isShowing})}render(){let e=this.state.isShowing?"visible":"hidden",t=this.props.intl.formatMessage({id:"component.autoplay.returnToTop"}),i=this.props.intl.formatMessage({id:"common.autoplay.play"}),s=this.props.intl.formatMessage({id:"common.autoplay.pause"}),a=this.props.intl.formatMessage({id:"component.autoplay.toggleSpeed"});return(0,o.jsxs)("div",{onMouseEnter:this.setHoverState,onMouseLeave:this.removeHoverState,className:r().dynamic([["912d6e49f6b2d5e7",[this.props.appOffset.bottom,f.default.spacing.xxl,f.default.spacing.xxxxs,P.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,f.default.spacing.xs,f.default.spacing.md,P.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay",children:[(0,o.jsxs)("div",{className:r().dynamic([["912d6e49f6b2d5e7",[this.props.appOffset.bottom,f.default.spacing.xxl,f.default.spacing.xxxxs,P.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,f.default.spacing.xs,f.default.spacing.md,P.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay-controls-wrapper",children:[(0,o.jsx)(ee.ZP,{type:"single-icon",onClick:this.props.onResetClick,"aria-label":t,children:(0,o.jsx)($.Z,{path:J.M})}),this.props.isPlaying?(0,o.jsx)(ee.ZP,{type:"single-icon",onClick:this.props.onPlayToggle,"aria-label":s,children:(0,o.jsx)($.Z,{path:"M4 2h6v20H4zm10 20h6V2h-6z"})}):(0,o.jsx)(ee.ZP,{type:"single-icon",onClick:this.props.onPlayToggle,"aria-label":i,children:(0,o.jsx)($.Z,{path:Q.C})}),(0,o.jsx)(ee.ZP,{type:"single-icon",onClick:this.props.onSpeedToggle,"aria-label":a,children:(0,o.jsx)($.Z,{path:et[this.props.speed]})})]}),(0,o.jsx)(r(),{id:"912d6e49f6b2d5e7",dynamic:[this.props.appOffset.bottom,f.default.spacing.xxl,f.default.spacing.xxxxs,P.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,f.default.spacing.xs,f.default.spacing.md,P.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xs,alignItems:"center",justifyContent:"center"})],children:`.autoplay.__jsx-style-dynamic-selector{position:fixed;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);bottom:-webkit-calc(${this.props.appOffset.bottom} + ${f.default.spacing.xxl});bottom:-moz-calc(${this.props.appOffset.bottom} + ${f.default.spacing.xxl});bottom:calc(${this.props.appOffset.bottom} + ${f.default.spacing.xxl});-webkit-border-radius:${f.default.spacing.xxxxs};-moz-border-radius:${f.default.spacing.xxxxs};border-radius:${f.default.spacing.xxxxs};background-color:${P.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85)};z-index:10;visibility:${e};opacity:${this.state.isShowing?1:0};-webkit-transition:opacity.5s linear,visibility.5s linear;-moz-transition:opacity.5s linear,visibility.5s linear;-o-transition:opacity.5s linear,visibility.5s linear;transition:opacity.5s linear,visibility.5s linear;padding:${f.default.spacing.xs} ${f.default.spacing.md}}.autoplay-controls-wrapper.__jsx-style-dynamic-selector{${P.ZP.gapped({direction:"horizontal",gap:f.default.spacing.xs,alignItems:"center",justifyContent:"center"})};}`})]})}}var es=(0,g.EL)((0,O.Jh)((0,p.ZP)(ei))),eo=i(590991);class ea extends n.PureComponent{constructor(e){var t;super(e),t=this,this.lastMouseMoveTime=0,this.lastScrollTime=0,this.isReaderScrolling=!1,this.autoplayNode=(0,n.createRef)(),this.autoplayEnabledSetup=async()=>{(0,T.xR)()||this.toggleAutoplay(),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("wheel",this.handleWindowScroll),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("touchstart",this.handleMouseDown),this.interactionTimer=window.setInterval(this.interactionDelayCheck,500),this.props.collectionBlock&&(await this.props.collectionBlock?.do("switchToCurrentActiveItem"),this.autoplayCollectionItem()),this.props.storyItem.type===I.o.Briefing&&this.autoplayBriefingSlide()},this.autoplayDisabledCleanup=()=>{clearInterval(this.interactionTimer),clearInterval(this.scrollTimer),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("wheel",this.handleWindowScroll),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("touchstart",this.handleMouseDown),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(eo.O4)},this.onReceiveMessage=e=>{e.origin===window.location.origin&&((0,T.xR)()?(e.data.method===eo.jf&&window.parent.postMessage({method:eo.Cd},window.location.origin),e.data.method===eo.fS&&e.data.speed&&(this.props.enableAutoplay(),this.props.updateAutoplaySpeed(e.data.speed),this.props.isAutoplayPaused&&this.toggleAutoplay()),e.data.method!==eo.O4||(this.props.disableAutoplay(),this.props.isAutoplayPaused||this.toggleAutoplay()),e.data.method===eo.sk&&this.toggleAutoplay(),e.data.method===eo.li&&e.data.speed&&this.props.updateAutoplaySpeed(e.data.speed),e.data.method===eo.Kj&&(this.props.onItemEndReached?.(),this.props.updateIsAutoplayPaused(!1),this.scrollPage())):(this.props.isAutoplayEnabled&&e.data.method===eo.An&&e.source?.postMessage({method:eo.fS,speed:this.props.autoplaySpeed}),e.data.method===eo.Cx&&e.source?.postMessage({method:eo.jf}),e.data.method===eo.Cd&&this.switchToNextItem(),e.data.method===eo.XR&&"boolean"==typeof e.data.isPaused&&this.props.isAutoplayPaused!==e.data.isPaused&&this.props.updateIsAutoplayPaused(e.data.isPaused)))},this.switchToNextItem=async e=>{await this.props.collectionBlock?.do("switchToNextItem",e),this.autoplayCollectionItem()},this.switchToFirstCollectionItem=()=>{this.switchToNextItem(0)},this.autoplayCollectionItem=()=>{clearTimeout(this.collectionTimeoutId);let e=eo.qi[this.props.autoplaySpeed].collectionAutoplayDuration;this.collectionTimeoutId=setTimeout(()=>{let e=this.props.collectionBlock?.do("getActiveItemBlock");if(!e)return;let t=e.do("isStoryMap"),i=e.do("getBlockItemType"),s=e.do("getItemUrl"),o=s?.startsWith(window?.origin);("embed"!==i||!o)&&(t&&o||this.switchToNextItem())},e)},this.postMessageToActiveItemIframe=(e,t)=>{let i=document.querySelector(`.${eo.l}`)?.contentWindow;i?.postMessage({method:e,...t})},this.autoplayBriefingSlide=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=eo.qi[t.props.autoplaySpeed].briefingAutoplayDuration,s=t.props.briefingDisplay.totalNumberOfSlides,o=t.props.briefingDisplay.currentIndex,a=o===s-1,r=o+1;if(clearTimeout(t.briefingTimeoutId),e){t.props.updateBriefingDisplay({currentIndex:0});return}t.briefingTimeoutId=setTimeout(()=>{if(a)return t.jumpToTop();t.props.updateBriefingDisplay({currentIndex:r})},i)},this.toggleAutoplay=e=>{let t=!this.props.isAutoplayPaused;e?.preventDefault(),this.props.updateIsAutoplayPaused(t),this.props.collectionBlock?(this.postMessageToActiveItemIframe(eo.sk),t?clearTimeout(this.collectionTimeoutId):this.autoplayCollectionItem()):this.props.storyItem.type===I.o.Briefing?t?clearTimeout(this.briefingTimeoutId):this.autoplayBriefingSlide():(window.parent.postMessage({method:eo.XR,isPaused:t}),this.scrollPage())},this.handleWindowScroll=e=>{(e.deltaY>0||e.deltaY<0)&&(this.updateScrollTime(),this.isReaderScrolling=!0,this.props.isAutoplayPaused||(this.props.updateIsAutoplayPaused(!0),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(eo.sk)))},this.handleMouseDown=e=>{this.props.isAutoplayPaused||this.autoplayNode.current?.contains(e.target)||(this.props.updateIsAutoplayPaused(!0),clearInterval(this.scrollTimer),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(eo.sk))},this.updateScrollTime=()=>{this.lastScrollTime=Date.now()},this.handleMouseMove=()=>{this.lastMouseMoveTime=Date.now(),this.setState({areAutoplayControlsShowing:!0})},this.interactionDelayCheck=()=>{if(!this.autoplayNode.current){clearInterval(this.interactionTimer);return}this.isReaderScrolling?this.onReaderScrolling():this.onReaderNotScrolling()},this.onReaderScrolling=()=>{Date.now()>this.lastScrollTime+eo.AD?this.isReaderScrolling=!1:this.setState({areAutoplayControlsShowing:!0})},this.onReaderNotScrolling=()=>{Date.now()>this.lastMouseMoveTime+eo.oc&&!this.props.isAutoplayPaused?this.setState({areAutoplayControlsShowing:!1}):this.setState({areAutoplayControlsShowing:!0})},this.toggleAutoplaySpeed=()=>{"fast"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("slow"):"slow"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("medium"):this.props.updateAutoplaySpeed("fast")},this.onResetClick=()=>{this.props.collectionBlock?(clearTimeout(this.collectionTimeoutId),this.switchToFirstCollectionItem(),this.postMessageToActiveItemIframe(eo.Kj),this.props.updateIsAutoplayPaused(!1)):this.props.storyItem.type===I.o.Briefing?(this.autoplayBriefingSlide(!0),this.props.updateIsAutoplayPaused(!1)):this.jumpToTop()},this.jumpToTop=()=>{this.props.onItemEndReached?.(),window.parent.postMessage({method:eo.Cx},window.location.origin),this.props.updateIsAutoplayPaused(!1),this.scrollPage()},this.scrollPage=()=>{let e=eo.qi[this.props.autoplaySpeed].pageScrollDelay;clearInterval(this.scrollTimer),this.scrollTimer=window.setInterval(()=>{if(this.props.isAutoplayPaused||!this.autoplayNode.current){clearInterval(this.scrollTimer);return}0===window.scrollY?(clearInterval(this.scrollTimer),setTimeout(()=>{window.scrollBy(0,2),this.scrollPage()},2e3)):Math.round(window.innerHeight+window.scrollY)>=document.body.offsetHeight?(clearInterval(this.scrollTimer),setTimeout(this.jumpToTop,3e3)):window.scrollBy(0,2)},e)},this.state={areAutoplayControlsShowing:!1}}componentDidMount(){window.addEventListener("message",this.onReceiveMessage,!1),(0,T.xR)()&&window.parent.postMessage({method:eo.An},window.location.origin)}componentDidUpdate(e,t){e.autoplaySpeed!==this.props.autoplaySpeed&&(this.scrollPage(),this.postMessageToActiveItemIframe(eo.li,{speed:this.props.autoplaySpeed}),this.autoplayBriefingSlide()),!e.isAutoplayEnabled&&this.props.isAutoplayEnabled&&this.autoplayEnabledSetup(),e.isAutoplayEnabled&&!this.props.isAutoplayEnabled&&this.autoplayDisabledCleanup(),(0,T.xR)()&&!this.props.isAutoplayEnabled&&window.parent.postMessage({method:eo.An},window.location.origin);let i=this.props.collectionDisplay.isCoverShowing;!e.collectionDisplay.isCoverShowing&&i&&this.props.isAutoplayEnabled&&this.props.disableAutoplay(),this.props.isAutoplayEnabled&&!this.props.isAutoplayPaused&&this.props.storyItem.type===I.o.Briefing&&this.props.briefingDisplay.currentIndex!==e.briefingDisplay.currentIndex&&this.autoplayBriefingSlide()}componentWillUnmount(){window.removeEventListener("message",this.onReceiveMessage,!1),this.autoplayDisabledCleanup()}render(){return this.props.isAutoplayEnabled?(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(q.Z,{triggerKey:" ",on:this.toggleAutoplay}),!this.props.isAutoplayPaused&&(0,o.jsx)(G.Z,{isShowing:!0,isInvisible:!0}),(0,o.jsx)("div",{ref:this.autoplayNode,children:(0,o.jsx)(es,{isShowing:!(0,T.xR)()&&this.state.areAutoplayControlsShowing,speed:eo.qi[this.props.autoplaySpeed].displaySpeed,isPlaying:!this.props.isAutoplayPaused,onResetClick:this.onResetClick,onPlayToggle:this.toggleAutoplay,onSpeedToggle:this.toggleAutoplaySpeed})})]}):null}}var er=(0,X.Z)((s=(0,N.p)((0,K.HH)(ea)),class extends n.PureComponent{render(){return(0,o.jsx)(Y.G.Consumer,{children:e=>(0,o.jsx)(s,{...this.props,...e})})}})),en=i(413329),el=i(79338),ep=i(249102),ed=i(136630),ec=i(332795);let eh={phone:{landscape:{width:734,height:388,fileName:"frame-phone-landscape.png"},portrait:{width:388,height:734,fileName:"frame-phone.png"}},tablet:{landscape:{width:1100,height:782,fileName:"frame-tablet-landscape.png"},portrait:{width:782,height:1100,fileName:"frame-tablet.png"}},desktop:{landscape:{width:1370,height:878,fileName:"frame-desktop.png"},portrait:{width:1370,height:878,fileName:"frame-desktop.png"}}};class eu extends n.Component{constructor(e){super(e),this.margins={top:65,bottom:130,side:65},this.scaleWrapper=(0,n.createRef)(),this.scaledPreview=(0,n.createRef)(),this.previewIframe=(0,n.createRef)(),this.handleResize=()=>{this.forceUpdate()},this.findTransformScale=()=>{let e=this.scaleWrapper.current?.getBoundingClientRect();if(!e)return 1;let t=eh[this.props.device];return+Math.min(Math.min(Math.round(e.height-this.margins.top-this.margins.bottom)/t.portrait.height,1),Math.min(Math.round(e.width-2*this.margins.side)/t.landscape.width,1)).toFixed(2)},this.findTopPosition=e=>{if(!this.scaleWrapper.current||!this.scaledPreview.current)return 0;let t=Math.round(this.scaleWrapper.current.getBoundingClientRect().height),i=Math.round(e||this.scaledPreview.current.getBoundingClientRect().height);return this.margins.top+(t-i-this.margins.top-this.margins.bottom)/2},this.handleResizeDebouncedly=(0,ed.Ds)(this.handleResize,200)}componentDidMount(){this.forceUpdate(),this.scrollWindowToTop(),window.addEventListener("resize",this.handleResizeDebouncedly)}componentDidUpdate(e){(e.device!==this.props.device||e.orientation!==this.props.orientation)&&this.scrollIframeToTop()}componentWillUnmount(){window.removeEventListener("resize",this.handleResizeDebouncedly)}render(){let e=eh[this.props.device][this.props.orientation],t=this.findTransformScale(),i=Math.round(e.height*t),s=this.findTopPosition(i),a=this.props.query?(0,ec.qC)(this.props.query):void 0,l=void 0===this.props.selectedItemId?a?`./embedded-preview?${a}`:"./embedded-preview":a?`./embedded-preview?item=${this.props.selectedItemId}&${a}`:`./embedded-preview?item=${this.props.selectedItemId}`;return(0,o.jsx)(n.Fragment,{children:(0,o.jsxs)("div",{ref:this.scaleWrapper,className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" "+`scale-wrapper ${this.props.device} ${this.props.orientation}`,children:[(0,o.jsx)("div",{className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" scaled",children:(0,o.jsx)("div",{ref:this.scaledPreview,className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" center-horizontally scaled-preview",children:(0,o.jsxs)("div",{className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" preview-container specified-dimensions",children:[(0,o.jsx)("img",{src:`${this.props.config.BASE_URL}/static/storymaps-website-common/images/device-preview/${e.fileName}`,alt:this.props.intl.formatMessage({id:"component.preview.chromeAlt"}),loading:"lazy",className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" device-chrome"}),(0,o.jsx)("iframe",{src:l,ref:this.previewIframe,loading:"lazy",className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])})]})})}),"desktop"!==this.props.device&&(0,o.jsx)("div",{className:r().dynamic([["180a5b1f03827713",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" rotate-button-wrapper center-horizontally",children:(0,o.jsx)(ee.ZP,{type:"single-icon",iconSize:24,onClick:this.props.onOrientationChange,"aria-label":this.props.intl.formatMessage({id:"component.preview.rotateLabel"}),children:(0,o.jsx)($.Z,{path:"M21.323 8.616l-4.94-4.94a1.251 1.251 0 0 0-1.767 0l-10.94 10.94a1.251 1.251 0 0 0 0 1.768l4.94 4.94a1.25 1.25 0 0 0 1.768 0l10.94-10.94a1.251 1.251 0 0 0 0-1.768zM14 5.707L19.293 11 11.5 18.793 6.207 13.5zm-4.323 14.91a.25.25 0 0 1-.354 0l-1.47-1.47.5-.5-2-2-.5.5-1.47-1.47a.25.25 0 0 1 0-.354L5.5 14.207l5.293 5.293zm10.94-10.94l-.617.616L14.707 5l.616-.616a.25.25 0 0 1 .354 0l4.94 4.94a.25.25 0 0 1 0 .353zm1.394 6.265V18a3.003 3.003 0 0 1-3 3h-3.292l1.635 1.634-.707.707-2.848-2.847 2.848-2.848.707.707L15.707 20h3.304a2.002 2.002 0 0 0 2-2v-2.058zM4 9H3V7a3.003 3.003 0 0 1 3-3h3.293L7.646 2.354l.707-.707 2.848 2.847L8.354 7.34l-.707-.707L9.28 5H6a2.002 2.002 0 0 0-2 2z"})})}),(0,o.jsx)(r(),{id:"180a5b1f03827713",dynamic:[this.props.websiteDesign.theme.colors.backgroundSecondary,t,s,f.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height],children:`.center-horizontally.__jsx-style-dynamic-selector{position:absolute;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);top:0}.scale-wrapper.__jsx-style-dynamic-selector{height:100vh;position:relative;background-color:${this.props.websiteDesign.theme.colors.backgroundSecondary}}.scaled.__jsx-style-dynamic-selector{-webkit-transform:scale(${t});-moz-transform:scale(${t});-ms-transform:scale(${t});-o-transform:scale(${t});transform:scale(${t});position:relative;top:${s}px}.preview-container.__jsx-style-dynamic-selector{margin:0 auto}.rotate-button-wrapper.__jsx-style-dynamic-selector{top:auto;bottom:${f.default.spacing.lg}}iframe.__jsx-style-dynamic-selector{position:absolute;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.${this.props.device}.${this.props.orientation}.__jsx-style-dynamic-selector .specified-dimensions.__jsx-style-dynamic-selector{width:${e.width}px;height:${e.height}px}.phone.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.8%;left:1.9%;height:90.4%;width:96.3%}.phone.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.8%;top:1.9%;width:90.4%;height:96.3%}.tablet.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.6%;left:1.4%;height:90.6%;width:97.2%}.tablet.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.6%;top:1.4%;width:90.6%;height:97.2%}.desktop.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:6.4%;left:1.8%;width:96.5%;height:90.9%}`})]})})}scrollWindowToTop(){let e=window?.document?.documentElement;e&&(e.scrollTop=0)}scrollIframeToTop(){try{let e=this.previewIframe?.current?.contentWindow?.document?.documentElement;e&&this.scrollToTop(e)}catch(e){}}scrollToTop(e){if(e.scrollTop>0){let t=e.clientHeight?Math.round(e.clientHeight/2):300;setTimeout(()=>{e.scrollBy(0,-1*t),this.scrollToTop(e)},10)}}}var em=(0,g.EL)((0,p.ZP)((0,D.Df)(eu))),eg=i(387651),ef=i(381e3),ey=i(344159),ex=i(657370),ew=i(92061),eb=i(841811),ev=i(548995),eI=i(531721);let eS="storyPreviewControlsNudge",eT="collectionPreviewControlsNudge";class ek extends n.Component{static #e=this.defaultProps={device:"fullscreen",onDeviceChange:()=>{}};constructor(e){super(e),this.deviceSpecs=[{value:"phone",iconProps:{path:eg.I},stringId:"component.previewHeader.device.phone",isUnavailable:this.props.storyItem.type===I.o.Briefing},{value:"tablet",iconProps:{path:"M15 14a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1zm-.25-10a.25.25 0 0 1 .25.25v8.5a.25.25 0 0 1-.25.25H14V4zM13 4v9H4V4zM1 9h1V8H1V4.25A.25.25 0 0 1 1.25 4H3v9H1.25a.25.25 0 0 1-.25-.25z",shouldFlipRTL:!0},stringId:"component.previewHeader.device.tablet",isUnavailable:this.props.storyItem.type===I.o.Briefing},{value:"desktop",iconProps:{path:ef.G},stringId:"component.previewHeader.device.desktop"},{value:"fullscreen",iconProps:{path:"M0 1v14h16V1zm1 13V5h4v9zm14 0H6V5h9zm0-10h-1V3h-1v1H1V2h14z",shouldFlipRTL:!0},stringId:"component.previewHeader.device.full"}],this.renderControls=()=>{let e=this.props.intl.formatMessage({id:"component.preview.controls.close"});return(0,o.jsxs)("div",{className:r().dynamic([["b26b452fdfb19963",[P.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),P.ZP.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid]]])+" preview-controls",children:[this.deviceSpecs.map(e=>{if(e.isUnavailable)return;let t=e.value,i=this.props.intl.formatMessage({id:e.stringId});return(0,o.jsx)(ew.h,{"aria-pressed":this.props.device===t,iconProps:e.iconProps,buttonId:e.stringId,onClick:()=>{this.onPreviewChangeWrapper(t)},tooltipContent:i},`${t}-frag`)}),(0,o.jsx)(eb.Z,{}),(0,o.jsx)(ev.e,{routeDef:(0,Z.kN)({route:"builder",itemId:this.props.storyItem.itemId,itemType:this.props.storyItem.type,isTemplate:this.props.storyItem.isTemplate}),children:(0,o.jsx)(ee.ZP,{type:"single-icon",className:"edit-link","aria-label":e,children:(0,o.jsx)(ey.Z,{tooltipContent:e,children:(0,o.jsx)($.Z,{path:j.n,size:16})})})}),(0,o.jsx)(r(),{id:"b26b452fdfb19963",dynamic:[P.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),P.ZP.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid],children:`.preview-controls.__jsx-style-dynamic-selector{${P.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"})};${P.ZP.shadow.md()}
            background-color: ${this.props.websiteDesign.theme.colors.surfaceDefault};-webkit-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};-moz-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};color:inherit}`})]})},this.onPreviewChangeWrapper=e=>{this.props.onDeviceChange&&this.props.onDeviceChange(e)},this.onNudgeDismissed=()=>{this.setState({hasSeenNudge:!0}),(0,eI.s)({id:this.props.storyItem.type===I.o.Story?eS:eT,value:!0})},this.state={hasSeenNudge:!!(0,eI.n)({id:this.props.storyItem.type===I.o.Story?eS:eT})}}render(){return(0,o.jsx)(ex.Z,{target:this.renderControls(),title:this.props.intl.formatMessage({id:"component.preview.controls.nudge.description"}),placement:"top",isShowing:!!this.props.canShowNudge&&!this.state.hasSeenNudge,onClick:this.onNudgeDismissed})}}var eD=(0,g.EL)((0,D.Df)((0,p.ZP)((0,O.Jh)((0,X.D)(ek))))),eA=i(179463),eC=i(972054),ej=i(368667),eP=i(902183),e_=i(447878),e$=i(863982),eL=i(457945);let eE=(e,t,i,s,o,a,r,n,l)=>JSON.stringify({"@context":"https://schema.org","@type":"NewsArticle",mainEntityOfPage:{"@type":"WebPage","@id":e},headline:`${a}`,image:[`${t}`],datePublished:`${i}`,dateModified:`${s}`,author:{"@type":"Person",name:`${o}`},publisher:{"@type":"Organization",name:"Esri",logo:{"@type":"ImageObject",url:`${n}${l.BASE_URL}/static/images/logo.png`}},description:`${r}`}),eM=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("link",{rel:"preconnect",href:"https://www.arcgis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://js.arcgis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://static.arcgis.com"})]});var eR=e=>{let{publishedDate:t,host:i,config:s,authorTrackingConfig:a}=e,r=(0,W.ZW)();if(r.type===I.o.Theme)throw Error("StoryItemMetaTags do not currently support theme items");let l=a&&(0,v.St)(a).isValidAnalyticsConfig,p=s.ESRI_MARKETING_ANALYTICS&&((r.itemDetails.typeKeywords??[]).includes(e$.hH)||"string"==typeof r.itemDetails.orgId&&s.ESRI_MARKETING_ANALYTICS.orgIds.includes(r.itemDetails.orgId))?s.ESRI_MARKETING_ANALYTICS.scriptSrc:void 0,{requestNextRouteChangeWithFullPageLoad:d,getUrlFromRouteDef:c}=(0,Z.Gr)();(0,n.useEffect)(()=>{(l||void 0!==p)&&d()},[l,p,d]);let h=(0,eA.Z)(!0),m=`${i?"https://"+i:(0,eC.o)({siteUrl:s.SITE_URL,isComponentMounted:h})}`,g=(0,ej.Sg)({portalHost:s.PORTAL_HOST,itemDetails:r.itemDetails,fallbackUrl:`${m}${(0,eL.Zr)(s.BASE_URL)}`,shouldIgnoreDPR:!0,returnOriginalAspectRatio:!0}),f=(0,k.G)(r.itemDetails),y=f?.metaProperties?.title?(0,ec.dW)(f?.metaProperties?.title):(0,ec.dW)(e.title),x=(0,ec.dW)(e.author),w=f?.metaProperties?.description?(0,ec.dW)(f?.metaProperties?.description):r.itemDetails.snippet?(0,ec.dW)(r.itemDetails.snippet):r.itemDetails.description?(0,ec.dW)(r.itemDetails.description):"",b=c((0,Z.kN)({route:"viewer",itemType:r.type,itemId:r.itemDetails.id,isTemplate:r.isTemplate})),S=(0,eP._$)({typeKeywords:r.itemDetails.typeKeywords,typeKeywordId:e_.L7})||!(0,ej._$)({itemDetails:r.itemDetails,isTemplate:r.isTemplate});return(0,o.jsxs)(u(),{children:[(0,o.jsx)("title",{children:y},"title"),(0,o.jsx)("meta",{name:"author",content:x},"author"),(0,o.jsx)("meta",{property:"article:published_time",content:t.toISOString()},"publishedDate"),(0,o.jsx)("link",{rel:"canonical",href:b}),(0,o.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:`${m}/oembed?url=${encodeURIComponent(b)}&format=json`,title:y}),(0,o.jsx)("link",{rel:"alternate",type:"text/xml+oembed",href:`${m}/oembed?url=${encodeURIComponent(b)}&format=xml`,title:y}),(0,o.jsx)(eM,{}),(void 0!==r.itemDetails.robots||S)&&(0,o.jsx)("meta",{name:"robots",content:S?"noindex, nofollow":"function"==typeof r.itemDetails.robots?.join?r.itemDetails.robots.join(","):"noindex, nofollow"}),(0,o.jsx)("meta",{property:"og:title",content:y},"og:title"),(0,o.jsx)("meta",{property:"og:description",content:w},"og:description"),(0,o.jsx)("meta",{property:"og:url",content:b},"og:url"),(0,o.jsx)("meta",{property:"og:image",content:g},"og:image"),(0,o.jsx)("meta",{name:"twitter:creator",content:x},"twitter:creator"),(0,o.jsx)("meta",{name:"twitter:url",content:b},"twitter:url"),(0,o.jsx)("meta",{name:"twitter:title",content:y},"twitter:title"),(0,o.jsx)("meta",{name:"twitter:description",content:w},"twitter:description"),(0,o.jsx)("meta",{name:"twitter:image",content:g},"twitter:image"),(0,o.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:`${eE(b,g,new Date(r.itemDetails.created).toISOString(),t.toISOString(),x,y,w,m,s)}`}}),p&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("script",{dangerouslySetInnerHTML:{__html:`(function(){window.dataLayer = Object.assign({}, window.dataLayer, {pageTitle: 'StoryMap: ${r.itemDetails.owner}: ' + document.title, pageName: 'StoryMap: ' + document.title, pageType: 'StoryMaps', pageSubType: 'StoryMap', domain: window.location.host, language: 'en',countryCode: 'us'});})()`}}),(0,o.jsx)("script",{src:p,async:!0})]})]})},eB=i(948667),eZ=i(321221);let eO=()=>{let{updateAppOffsetValues:e,top:t}=(0,O.YO)();return(0,n.useEffect)(()=>{t!==eZ.g&&e({top:{storyHeader:(0,ec.wA)(eZ.g)}})},[]),null},eH=e=>{let{shouldShowHeader:t,children:i}=e,{updateAppOffsetValues:s,top:a}=(0,O.YO)(),r=a===eZ.g,l=(0,n.useCallback)(()=>{s({top:{storyHeader:r?0:(0,ec.wA)(eZ.g)}})},[s,r]);return(0,o.jsxs)(o.Fragment,{children:[t&&(0,o.jsx)(eO,{}),(0,o.jsx)(q.Z,{triggerKey:"\\",isMeta:!0,on:l}),r&&i]})};var eN=i(108624),ez=i(504908),eU=i(185843),eV=e=>(0,o.jsx)(ee.ZP,{type:"secondary",className:e.className,onClick:()=>window.history.back(),children:(0,o.jsx)(l.Z,{id:"page.error.back"})});class eW extends n.PureComponent{render(){return(0,o.jsx)(ee.ZP,{className:this.props.className,onClick:this.print,children:(0,o.jsx)(l.Z,{id:"common.print"})})}constructor(...e){super(...e),this.print=()=>{S.Z.trackEvent(S.Z.Category.Viewer,S.Z.Action.Viewer_Print),window.print()}}}var eF=()=>{let e={styles:(0,o.jsx)(r(),{id:"ff2bbe251c0e47dd",dynamic:[f.default.spacing.xs],children:`.side-margins.__jsx-style-dynamic-selector{margin:0 ${f.default.spacing.xs}}`}),className:r().dynamic([["ff2bbe251c0e47dd",[f.default.spacing.xs]]])};return(0,o.jsxs)("div",{className:r().dynamic([["9c8ebce0cb77e47d",[f.default.spacing.lg,f.default.spacing.xs,y.Kk.RTL]]])+" basic-wrapper",children:[(0,o.jsxs)("div",{className:r().dynamic([["9c8ebce0cb77e47d",[f.default.spacing.lg,f.default.spacing.xs,y.Kk.RTL]]])+" print-wrapper",children:[(0,o.jsx)(eW,{className:`side-margins ${e.className}`}),(0,o.jsx)(eV,{className:`side-margins ${e.className}`})]}),(0,o.jsx)(r(),{id:"9c8ebce0cb77e47d",dynamic:[f.default.spacing.lg,f.default.spacing.xs,y.Kk.RTL],children:`.basic-wrapper.__jsx-style-dynamic-selector{position:relative;display:none}@media screen{.basic-wrapper.__jsx-style-dynamic-selector{display:block}}.print-wrapper.__jsx-style-dynamic-selector{position:absolute;top:${f.default.spacing.lg};left:100%;display:grid;grid-gap:${f.default.spacing.xs}}${y.Kk.RTL} .print-wrapper.__jsx-style-dynamic-selector{left:unset;right:100%}`}),e.styles]})},eK=e=>{let{vertical:t}=(0,O.YO)(),{theme:i}=(0,g.Fj)(),s=c()("viewer-main",e$.MH,e.mainClassName,{"device-preview":"preview"===e.mode});return(0,o.jsxs)(eU.Z,{className:c()({"inline-story":e.isInlineStory}),children:[e.viewerHeader,e.printMode&&(0,o.jsx)(eF,{}),(0,o.jsx)("main",{className:r().dynamic([["8130e9d918a1c8ae",[f.default.print.pageWidthLetter,f.default.print.backgroundColor]],["d063f484d88fd766",[t,i.colors.focus,t]]])+" "+(s||""),children:e.children}),(0,o.jsx)(r(),{id:"d063f484d88fd766",dynamic:[t,i.colors.focus,t],children:`.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100vh - ${t});min-height:-moz-calc(100vh - ${t});min-height:calc(100vh - ${t})}.viewer-main.device-preview.__jsx-style-dynamic-selector{min-height:0}*:focus{outline-color:${i.colors.focus}}body.print .viewer-main.__jsx-style-dynamic-selector{min-height:0}@supports(height:1svh){.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100svh - ${t});min-height:-moz-calc(100svh - ${t});min-height:calc(100svh - ${t})}}`}),(0,o.jsx)(r(),{id:"8130e9d918a1c8ae",dynamic:[f.default.print.pageWidthLetter,f.default.print.backgroundColor],children:`body.print{width:${f.default.print.pageWidthLetter};margin:0 auto}body.print .page-container{background:${f.default.print.backgroundColor}}`})]})},eq=i(49969);class eG extends n.PureComponent{constructor(e){super(e),this.setAuthorTrackerFromConfig=()=>{this.trackingDetails=this.getAuthorTrackerDetails(),this.trackingType=this.trackingDetails?.type;let e=(0,v.St)(this.trackingDetails);if(void 0!==this.trackingDetails&&!this.state.hasActiveAuthorTracker&&e.isValidAnalyticsConfig){v.YX.setup({portal:this.props.portalSelfResponse,isPortal:this.props.isPortal,authorTrackingConfig:this.trackingDetails});try{v.YX.instance.startupTracker(),this.setState({hasActiveAuthorTracker:!0})}catch(e){this.setState({hasActiveAuthorTracker:!1}),console.error("Error starting author tracker",e)}}},this.handleEmbeddedCollectionUpdate=e=>{let{currentIndex:t,isItemViewTransitionComplete:i,isCoverShowing:s}=e.detail;this.props.collectionDisplay.updateCollectionDisplay({currentIndex:t,isItemViewTransitionComplete:i,isCoverShowing:s})},this.getItemViewerHeader=()=>{let e=this.props.storyItem.getItemPublishStatus(),t=this.props.storyItem.itemSharingLevel,i=this.props.storyItem.itemDetails&&"embedded-preview"!==this.props.mode&&"preview"!==this.props.mode&&!this.props.storyItem.itemDetails.origin&&("admin"===this.props.storyItem.itemDetails.itemControl||"update"===this.props.storyItem.itemDetails.itemControl),s={...this.props,storyId:this.props.storyItem.itemId,title:this.state.title,isOrgItem:this.props.storyItem.isOrgItem,itemOwner:this.props.storyItem.itemOwner,storyType:this.props.itemType,publishStatus:e,sharingLevel:t,canEdit:i,areSocialIconsHidden:this.state.areSocialIconsHidden,appLogo:this.props.appLogo,shouldShowSkipLink:!0,hashForSkipLink:this.state.hashForSkipLink,shouldShowLogoInHeader:this.props.storyContext.storyLogo?.shouldShowLogoInHeader??!0};switch(this.props.itemType){case I.o.Story:return(0,o.jsx)(eB.Z,{...s,canShowItemTitle:this.props.canShowItemTitle,onTitleClicked:this.resetItemBlock});case I.o.Collection:return(0,o.jsx)(ep.Z,{...s,canShowItemTitle:this.props.canShowItemTitle,getItemHref:this.getItemHref});case I.o.Briefing:return(0,o.jsx)(en.Z,{...s,onTitleClicked:this.resetItemBlock});case I.o.Frame:return(0,o.jsx)(o.Fragment,{});default:throw Error("No story item type provided")}},this.getBannerStringId=()=>this.props.itemType===I.o.Frame?"frames.preview.banner":"common.banner.viewDraftStory.mobile",this.getItemHref=e=>this.itemBlock?.do("getItemUrl",e),this.renderBanner=e=>(0,o.jsxs)(n.Fragment,{children:["fullscreen-preview"===e&&(!this.props.isViewportMinWidth("large")||this.props.itemType===I.o.Frame)&&(0,o.jsx)("div",{className:r().dynamic([["3f0395a02f103140",[this.props.appOffset.top]]])+" draft-preview-banner",children:(0,o.jsx)(m.Z,{size:"small",title:(0,o.jsx)(l.Z,{id:this.getBannerStringId()}),backgroundColor:this.props.websiteDesign.theme.colors.interactiveDefault,textColor:this.props.websiteDesign.theme.colors.labelPrimaryReverse,closeBtnColor:this.props.websiteDesign.theme.colors.labelPrimaryReverse,closeButtonLabel:this.props.intl.formatMessage({id:"common.close"})})}),(0,o.jsx)(r(),{id:"3f0395a02f103140",dynamic:[this.props.appOffset.top],children:`.draft-preview-banner.__jsx-style-dynamic-selector{position:absolute;top:${this.props.appOffset.top};left:0;width:100%;z-index:1}body.print .draft-preview-banner.__jsx-style-dynamic-selector{display:none}body.frame{-webkit-touch-callout:none;-webkit-user-select:none}`})]}),this.renderBody=e=>"preview"===e&&"fullscreen"!==this.state.previewDevice?(0,o.jsx)(em,{device:this.state.previewDevice,orientation:this.state.previewOrientation,onOrientationChange:this.onOrientationChange,query:this.props.query,...this.props.itemType===I.o.Collection&&{selectedItemId:(this.state.collectionItemIndex+1).toString()}}):(0,o.jsxs)(o.Fragment,{children:[this.state.ui,this.renderBanner(e)]}),this.onOrientationChange=()=>{let e="landscape"===this.state.previewOrientation?"portrait":"landscape";this.setState({previewOrientation:e})},this.onPreviewDeviceChange=e=>{if(e){let t={previewDevice:e};"phone"===e?(Object.assign(t,{previewOrientation:"portrait"}),S.Z.trackEvent(S.Z.Category.Preview,S.Z.Action.Preview_Device_Phone)):"tablet"===e&&(Object.assign(t,{previewOrientation:"landscape"}),S.Z.trackEvent(S.Z.Category.Preview,S.Z.Action.Preview_Device_Tablet)),this.setState(t,()=>{this.props.onPreviewDeviceChange?.(e)})}},this.resetItemBlock=()=>{this.itemBlock?.do("reset")},this.getAuthorTrackerDetails=()=>{let e=!this.props.environment.isPortal||this.props.featureDecisions.canHaveAuthorAnalytics,t=(0,eN.C5)(this.props.storyItem,e,this.props.printMode);if("view"===this.props.mode&&t&&(!t||!t.consentMessage||this.state.hasUserAcceptedAuthorAnalytics))return t},this.onAuthorAnalyticsConsentMessageAccepted=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!0},()=>{this.setAuthorTrackerFromConfig()})},this.onAuthorAnalyticsConsentMessageDismissed=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1})},this.jumpToBlock=()=>{let e=this.props.itemType===I.o.Briefing?0:100,t=0,i=0,s=document.body.offsetHeight,o=setInterval(async()=>{i++;let e=document.body.offsetHeight;e===s?t++:(s=e,t=0),(t>=30||i>=100)&&(clearInterval(o),(0,eN.G1)(),this.state.linkedBlockId&&await this.itemBlock?.do("jumpToBlock",this.state.linkedBlockId))},e)},this.getHasDocumentLoaded=()=>"undefined"!=typeof document&&"complete"===document.readyState,this.onWindowLoaded=()=>{this.setState({hasPageLoaded:!0}),this.state.linkedBlockId&&this.state.hasItemRendered&&this.jumpToBlock()},this.getBylineFromStoryItemData=(e,t,i)=>{if(t===I.o.Story){let t=e.nodes[e.root];if(!t.children)return"";for(let i of t.children){let t=e.nodes[i];if(t&&"storycover"===t.type)return t.data?.byline}}else if(t===I.o.Collection){for(let t of Object.values(e.nodes))if(t&&"collection-cover"===t.type)return t.data?.byline}else if(t===I.o.Frame)return i||"";else if(t===I.o.Briefing){for(let t of Object.values(e.nodes))if(t&&"storycover"===t.type)return t.data?.byline}else throw Error("only call getBylineFromStoryItemData for gemini items");return""},this.state={ui:void 0,viewerHeaderTheme:this.props.itemType===I.o.Briefing?"dark":"light",title:this.props.storyItem.itemDetails?.title||"",areSocialIconsHidden:!1,previewDevice:"fullscreen",previewOrientation:"landscape",isMounted:!1,isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!1,hasActiveAuthorTracker:!1,hasPageLoaded:this.getHasDocumentLoaded(),linkedBlockId:this.props.canJumpToLinkedBlock&&!this.props.printMode?(0,eN.g2)():void 0,hasItemRendered:!1,collectionItemIndex:this.props.initialCollectionItemIndex??-1}}componentDidMount(){(0,eq.u)(this),this.setState({isMounted:!0}),this.state.linkedBlockId&&(this.getHasDocumentLoaded()?this.onWindowLoaded():window.addEventListener("load",this.onWindowLoaded)),this.props.itemType===I.o.Collection&&document.addEventListener("embeddedCollectionUpdate",this.handleEmbeddedCollectionUpdate);let e="view"===this.props.mode?this.props.storyItem.itemData:this.props.storyItem.itemDraftData,t={shouldHideItemActions:this.props.storyItem.itemId===ez.BD||this.props.shouldHideItemActions||!!this.props.printMode||"view"!==this.props.mode,printMode:this.props.printMode,viewMode:this.props.mode,lazy:!this.props.printMode,storyItem:this.props.storyItem,config:this.props.config,featureDecisions:this.props.featureDecisions,environment:this.props.environment,toast:this.props.toast,portalSelfResponse:this.props.portalSelfResponse,authManager:this.props.authManager,getIntl:()=>this.props.intl,getAppOffset:()=>this.props.appOffset,getStoryOffset:()=>this.props.storyOffsetContext,getStoryDesignContext:()=>this.props.storyDesign,getStoryRouting:()=>this.props.storyRouting,getStoryContext:()=>this.props.storyContext,root:{initialThemeItemInfo:this.props.initialThemeItemInfo},canCopyLinks:!this.props.isInlineStory&&!(0,T.XU)(),...this.props.itemType===I.o.Collection&&{lazy:!1,getCollectionContextDisplay:()=>this.props.collectionDisplay,getCollectionContextData:()=>this.props.collectionData,isShowingCollectionItem:!this.props.collectionDisplay.isCoverShowing}},i=!1;{let e=window.location.search;e.includes("lazy=false")&&Object.assign(t,{lazy:!1}),e.includes("lab=true")&&(i=!0,Object.assign(t,{lab:!0})),document&&document.body&&this.props.printMode&&document.body.classList.add("print",this.props.printMode),document&&document.body&&this.props.itemType===I.o.Frame&&document.body.classList.add("frame")}(0,C.J_)({data:e,mode:"viewer",context:{...t},registry:(0,B.J)({featureDecisions:this.props.featureDecisions,includeLabItems:i})}).then(e=>{this.itemBlock=e;let t=this.itemBlock.do("getStoryTheme");return this.setState({viewerHeaderTheme:this.props.itemType===I.o.Briefing?"dark":t.websiteThemeFlavor,title:this.itemBlock.do("getCoverTitle"),areSocialIconsHidden:this.itemBlock.do("isSocialIconsHidden"),coverData:this.itemBlock.do("getCoverData"),hashForSkipLink:this.itemBlock.do("getSkipLinkHash")}),this.itemBlock.render()}).then(e=>{this.setAuthorTrackerFromConfig(),this.setState({ui:e,hasItemRendered:!0,isAuthorAnalyticsConsentMessageShowing:"view"===this.props.mode&&!this.props.printMode&&!!this.itemBlock?.do("getAuthorAnalytics")&&!!(this.itemBlock?.do("getAuthorAnalytics")).consentMessage}),this.state.linkedBlockId&&this.state.hasPageLoaded&&this.jumpToBlock()}).then(()=>{if("view"===this.props.mode&&this.props.storyItem.itemId!==ez.BD)try{(0,H.Az)({itemId:this.props.storyItem.itemId,portalHost:this.props.config.PORTAL_HOST,authManager:this.props.authManager,customTracker:this.props.itemViewTracker})}catch(e){}}).catch(e=>{S.Z.trackEvent(S.Z.Category.Viewer,S.Z.Action.Story_Render_Error,this.props.storyItem.itemId),this.props.redirectOnLoadError({config:this.props.config,signInUrl:this.props.signInUrl,authManager:this.props.authManager})})}componentDidUpdate(e){if(this.props.itemType===I.o.Collection){let{currentIndex:t,isCoverShowing:i,isItemViewTransitionComplete:s}=e.collectionDisplay,{currentIndex:o,isCoverShowing:a,isItemViewTransitionComplete:r}=this.props.collectionDisplay,n=i!==a||t!==o,l=n||s!==r;if((0,T.xR)()&&"embedded-preview"===this.props.mode&&l){let e=new CustomEvent("embeddedCollectionUpdate",{detail:{currentIndex:o,isItemViewTransitionComplete:r,isCoverShowing:a}});try{window.parent?.document.dispatchEvent(e)}catch{}return}if(n){let e=this.props.storyItem.itemDetails.id,t=`${this.props.config.BASE_URL}/collections/${e}`;if("preview"===this.props.mode&&(t=`${t}/preview`),!a){let e=new URLSearchParams(window.location.search);e.set("item",`${o+1}`),t=`${t}?${e}`}window.history.replaceState(null,"",t)}if("fullscreen"!==this.state.previewDevice)return;let p=a?-1:o;this.state.collectionItemIndex!==p&&this.setState({collectionItemIndex:p})}}componentWillUnmount(){this.setState({isMounted:!1}),window.removeEventListener("load",this.onWindowLoaded),document.removeEventListener("embeddedCollectionUpdate",this.handleEmbeddedCollectionUpdate)}render(){let e=this.itemBlock?.do("getMetaSettings"),t=(0,eN.RC)({itemType:this.props.itemType,isTemplate:this.props.storyItem.isTemplate,title:e?.title??this.state.title,formatMessage:this.props.intl.formatMessage}),i=this.props.mode;"preview"!==this.props.mode||"fullscreen"!==this.state.previewDevice&&this.props.isViewportMinWidth("large")||(i="fullscreen-preview");let s=!this.props.printMode&&("preview"===this.props.mode||"fullscreen-preview"===this.props.mode&&this.props.isViewportMinWidth("large")),a=this.props.shouldShowViewerHeader&&("preview"!==this.props.mode||"preview"===this.props.mode&&"fullscreen"===this.state.previewDevice),l=this.props.itemType===I.o.Briefing?(0,o.jsx)(g.tT,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:(0,o.jsx)(eH,{shouldShowHeader:!!a,children:this.getItemViewerHeader()})}):a?(0,o.jsx)(g.tT,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:this.getItemViewerHeader()}):null,p=(0,k.G)(this.props.storyItem.itemDetails),d=p?.metaProperties?.description||this.props.storyItem.itemDetails.snippet,h={styles:(0,o.jsx)(r(),{id:"de66ee6ec6ca8409",dynamic:[this.props.websiteDesign.theme.colors.backgroundPrimary],children:`.briefing-viewer-main.__jsx-style-dynamic-selector{background-color:${this.props.websiteDesign.theme.colors.backgroundPrimary}}`}),className:r().dynamic([["de66ee6ec6ca8409",[this.props.websiteDesign.theme.colors.backgroundPrimary]]])},m=this.props.itemType===I.o.Story||this.props.itemType===I.o.Briefing||this.props.itemType===I.o.Frame,x=this.state.hasItemRendered&&!this.props.printMode&&this.props.postStoryContent;return(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(el.Z,{children:t}),d&&(0,o.jsx)(u(),{children:(0,o.jsx)("meta",{name:"description",content:d,className:r().dynamic([["7dfaca77bb380e4b",[this.props.appOffset.bottom,f.default.spacing.md,y.Kk.RTL]]])},"description")}),m&&(0,o.jsx)(M.Z,{}),(0,o.jsx)(W.ZP.Provider,{value:this.props.storyItem,children:(0,o.jsx)(K.UV,{initialQuery:this.props.query,children:(0,o.jsx)(U.dX,{children:(0,o.jsxs)(z.H9,{children:[this.props.storyItem.itemDetails&&this.props.storyItem&&this.props.storyItem.itemData&&this.props.storyItem.getItemPublishDate()&&(0,o.jsx)(eR,{title:t,author:this.getBylineFromStoryItemData(this.props.storyItem.itemData,this.props.itemType,this.props.itemOwnerFullName),publishedDate:this.props.storyItem.getItemPublishDate(),host:this.props.host,config:this.props.config,authorTrackingConfig:this.getAuthorTrackerDetails()}),this.state.isAuthorAnalyticsConsentMessageShowing&&(0,o.jsx)(E,{onAllowClicked:this.onAuthorAnalyticsConsentMessageAccepted,onDismissClicked:this.onAuthorAnalyticsConsentMessageDismissed,message:this.itemBlock?.do("getAuthorAnalytics")?.consentMessage??""}),(0,o.jsxs)(eK,{...this.props,viewerHeader:l,mode:i,printMode:this.props.printMode,isInlineStory:this.props.isInlineStory,mainClassName:this.props.itemType===I.o.Briefing?c()(h.className,"briefing-viewer-main"):void 0,children:[(0,o.jsx)(er,{onItemEndReached:this.resetItemBlock,collectionBlock:this.props.itemType===I.o.Collection?this.itemBlock:void 0}),s&&this.props.isViewportMinWidth("large")&&this.state.isMounted&&this.props.itemType!==I.o.Frame&&(0,o.jsx)("div",{className:r().dynamic([["7dfaca77bb380e4b",[this.props.appOffset.bottom,f.default.spacing.md,y.Kk.RTL]]])+" preview-controls-container",children:(0,o.jsx)(g.tT,{defaultTheme:"light",children:(0,o.jsx)(eD,{onDeviceChange:this.onPreviewDeviceChange,device:this.state.previewDevice,canShowNudge:this.props.canShowPreviewControlsNudge})})}),this.renderBody(i),this.props.footerBanner,x&&(0,o.jsx)(g.tT,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:this.props.postStoryContent})]})]})})})}),(0,o.jsx)(r(),{id:"7dfaca77bb380e4b",dynamic:[this.props.appOffset.bottom,f.default.spacing.md,y.Kk.RTL],children:`.preview-controls-container.__jsx-style-dynamic-selector{position:fixed;z-index:98;bottom:-webkit-calc(${this.props.appOffset.bottom} + ${f.default.spacing.md});bottom:-moz-calc(${this.props.appOffset.bottom} + ${f.default.spacing.md});bottom:calc(${this.props.appOffset.bottom} + ${f.default.spacing.md});right:7.2rem}${y.Kk.RTL} .preview-controls-container.__jsx-style-dynamic-selector{right:unset;left:7.2rem}`}),this.props.itemType===I.o.Briefing&&h.styles]})}}var eY=(0,R.Fv)((0,g.EL)((0,D.Df)((0,p.ZP)((0,Z.Jy)((0,F.F)((0,A.oh)((0,O.Jh)((0,x.d2)((0,w.ZP)((0,b.VO)((0,V.w)((0,N.p)(eG)))))))))))))},504908:function(e,t,i){i.d(t,{BD:function(){return r},kS:function(){return p},nt:function(){return o}});var s,o,a=i(447878);let r="sample32charactersvaliditemidaaa",n=e=>{let t=Date.now();return{id:r,owner:"StoryMaps Team",created:t,modified:t,title:e?.({id:"component.themeEditor.storyHeaderText"})??"",type:a.Cs,typeKeywords:["arcgis-storymaps",`smdraftresourceid:${a.AY}0.json`,`smpublisheddate:${t}`,"smstatuspublished","smversiondraft:20.27.0","smversionpublished:20.27.0","StoryMap","Web Application"],tags:[""],numViews:0,size:0}},l=e=>{let{formatMessage:t,baseUrl:i,siteUrl:s,productName:o,baseThemeId:a}=e,r=e=>{let[i]=e;return t?.({id:`component.themePreviewSampleStory.${i}`})??""};return{root:"n-lMEvw3",nodes:{"n-ZEqBEg":{type:"storycover",data:{type:"minimal",title:r`storycover.title`,summary:r`storycover.summary`,byline:o,titlePanelHorizontalPosition:"start"}},"n-YKldSA":{type:"navigation",data:{links:[{nodeId:"n-VMrERe"}]},config:{isHidden:!0}},"n-EDAcop":{type:"text",data:{text:r`text1`,type:"paragraph"}},"n-erhBAh":{type:"text",data:{text:r`text2`,type:"paragraph"}},"n-PHc2cM":{type:"button",data:{text:r`button.text`,link:""}},"n-VMrERe":{type:"text",data:{type:"h2",text:r`text3`}},"n-lfXBaT":{type:"text",data:{text:r`text4`,type:"paragraph"}},"n-links":{type:"text",data:{text:r`link`,type:"paragraph"}},"n-vbQaVc":{type:"text",data:{text:r`text5`,type:"quote",attribution:r`text5a`}},"n-Y2phK6":{type:"text",data:{text:r`text6`,type:"h3"}},"n-CKO4Ak":{type:"text",data:{text:r`text7`,type:"paragraph"}},"n-expressmap":{type:"expressmap",data:{map:"r-expressmap",alt:"",caption:r`expressmap.caption`},config:{size:"standard"}},"n-6bhWAJ":{type:"text",data:{type:"paragraph",text:r`text8`}},"n-4Dsx7p":{type:"separator"},"n-EcdqDK":{type:"audio",data:{audio:"r-j7OSzQ",caption:r`audio.caption`}},"n-7KLTO8":{type:"text",data:{text:r`text9`,type:"paragraph"}},"n-r7trnc":{type:"embed",data:{url:s+i,embedType:"link",title:o,description:t?.({id:"page.index.subtitle"})??"",thumbnailUrl:`${i}/static/images/social-sharing-card.jpeg?v=22.15`,providerUrl:s,caption:o,display:"card"}},"n-8CSjqa":{type:"text",data:{text:r`text10`,type:"h4"}},"n-1GjFLq":{type:"text",data:{text:r`text11`,type:"paragraph"}},"n-80Orlw":{type:"attribution",data:{content:r`attribution.content`,attribution:r`attribution.attribution`}},"n-TiLsTS":{type:"credits",children:["n-8CSjqa","n-1GjFLq","n-80Orlw"]},"n-lMEvw3":{type:"story",data:{storyTheme:"r-82O3KC"},children:["n-ZEqBEg","n-YKldSA","n-EDAcop","n-erhBAh","n-PHc2cM","n-VMrERe","n-lfXBaT","n-links","n-vbQaVc","n-Y2phK6","n-CKO4Ak","n-expressmap","n-4Dsx7p","n-6bhWAJ","n-EcdqDK","n-7KLTO8","n-r7trnc","n-TiLsTS"]}},resources:{"r-expressmap":{type:"expressmap",data:{src:`${i}/static/storymaps-builder/expressmaps/theme_preview_sample_expressmap.json`,provider:"uri"}},"r-j7OSzQ":{type:"audio",data:{src:`${i}/static/storymaps-builder/audio/theme_preview_sample_audio.wav`,provider:"uri"}},"r-82O3KC":{type:"story-theme",data:{themeId:a,themeBaseVariableOverrides:{}}}}}};(s=o||(o={})).AUDIO="n-EcdqDK",s.BUTTON="n-PHc2cM",s.SEPARATOR="n-4Dsx7p",s.STORYCOVER="n-ZEqBEg",s.QUOTE="n-vbQaVc",s.LINK="n-links",s.EXPRESSMAP="n-expressmap";let p=e=>({id:r,draftData:l(e),itemDetails:n(e.formatMessage)})},23027:function(e,t,i){i.d(t,{C:function(){return a},G:function(){return o}});var s=i(202784);let o=(0,s.createContext)({briefingDisplay:{currentIndex:0,totalNumberOfSlides:0,isStoryItemOutlineShowing:!1},updateBriefingDisplay:()=>{},setOnUpdateCurrentlyIndex:()=>null}),a=()=>(0,s.useContext)(o)},298382:function(e,t,i){i.d(t,{W:function(){return s}});let s=(0,i(202784).createContext)({collectionData:{titlesArray:[],updateCollectionData:()=>{}},collectionDisplay:{currentIndex:-1,isCoverShowing:!0,isItemViewTransitionComplete:!1,updateCollectionDisplay:()=>{}}})},56867:function(e,t,i){i.d(t,{Od:function(){return a}}),i(552322);var s=i(202784);let o=(0,s.createContext)({translateContentIntoLocale:()=>void 0,submitTranslationFeedback:()=>void 0,allSupportedLanguages:[]}),a=()=>(0,s.useContext)(o)},544213:function(e,t,i){i.d(t,{Gt:function(){return r},dX:function(){return n},uH:function(){return l}});var s=i(552322),o=i(202784);let a=(0,o.createContext)({isExpanded:!1,updateIsExpanded:()=>void 0}),r=()=>(0,o.useContext)(a),n=e=>{let{children:t}=e,[i,r]=(0,o.useState)({}),n=(0,o.useCallback)((e,t)=>{if(e&&!i[t])r({...i,[t]:!0});else if(!e&&i[t]){let e={...i};delete e[t],r(e)}},[i]),l=(0,o.useMemo)(()=>({isExpanded:!!Object.values(i).length,updateIsExpanded:n}),[i,n]);return(0,s.jsx)(a.Provider,{value:l,children:t})},l=e=>class extends o.PureComponent{render(){return(0,s.jsx)(a.Consumer,{children:t=>(0,s.jsx)(e,{...this.props,mediaExpandedContext:t})})}}},292963:function(e,t,i){i.d(t,{e:function(){return a},k:function(){return o}});var s=i(202784);let o=(0,s.createContext)({toggleDesignPanelHook:()=>{},updateStoryContext:()=>{},storyLogo:{src:"https://example.org/logo.png",link:"https://example.org",alt:"alt",shouldShowLogoInHeader:!0,shouldShowLogoOnCover:!1}}),a=()=>(0,s.useContext)(o)},150459:function(e,t,i){i.d(t,{b:function(){return r}});var s=i(552322),o=i(202784),a=i(292963);let r=e=>{let[t,i]=(0,o.useState)({});return(0,s.jsx)(a.k.Provider,{value:{...t,updateStoryContext:e=>{i(t=>({...t,...e}))}},children:e.children})}},969124:function(e,t,i){i.d(t,{B:function(){return s}});let s=(0,i(202784).createContext)({updateStoryOffsetContext:()=>{},storyOffset:{navBarHeight:"0rem"}})},614549:function(e,t,i){i.d(t,{Db:function(){return m},Mq:function(){return h},NH:function(){return u},Yx:function(){return f},kE:function(){return g},kz:function(){return c}});var s=i(552322),o=i(202784),a=i(69378),r=i(355125),n=i(81052),l=i(850358),p=i(580279),d=i(56867);let c=e=>e.nodes[e.root]?.config?.storyLocale,h=async e=>{{let{setLocale:t}=await Promise.all([i.e(72325),i.e(21154),i.e(4516)]).then(i.bind(i,504516));t(e??window.document.documentElement.lang??"en")}},u=async(e,t)=>{let i=t||window?.document?.documentElement?.lang||"en-us",s=`${(0,n.Zl)(e)}/portals/regions?f=json&culture=${i}`;return await (0,a.WY)(s)},m=e=>e.map((e,t)=>({id:t,labelId:"",label:e.localizedName,searchModifier:"",iSearchOptions:{categories:`/Region/${e.region}`}})),g=e=>{let{authManager:t}=(0,r.Pc)(),i=(0,l.ZR)(),{allSupportedLanguages:s}=(0,d.Od)(),[a,c]=(0,o.useState)(),h=(0,n.Zl)(i.PORTAL_HOST,t),u=(0,o.useMemo)(()=>{let t=e?.supportedLocales?.map(e=>p.dA(e,s))??[];return new Set(t)},[e?.supportedLocales,s]);return(0,o.useEffect)(()=>{(async()=>{if(h)try{let e=await (0,p.hN)(h);c(e)}catch(e){console.error(e)}})()},[h]),(0,o.useMemo)(()=>a?u.size?a.filter(e=>{let t=(0,p.dA)(e.culture,s);return u.has(t)}):a:void 0,[a,u,s])},f=(e,t)=>i=>{let o=g(t);return(0,s.jsx)(e,{portalLanguages:o,...i})}},497872:function(e,t,i){i.d(t,{J:function(){return s}});let s=e=>"string"==typeof e&&/^[a-zA-Z\d]{32}$/g.test(e)},705548:function(e,t,i){i.d(t,{z:function(){return s}});let s=(e,t,i)=>i.indexOf(e)===t},949843:function(e,t,i){i.d(t,{tz:function(){return P},A5:function(){return C}});var s=i(612423),o=i(718895),a=i(752179),r=i(614549),n=i(163891),l=i(307411),p=i(567523),d=i(504908),c=i(140995),h=i(936190),u=i(457945),m=i(902183),g=i(293786),f=i(69378),y=i(641391),x=i(136630);let w=async(e,t,i)=>{let s;let o=e=>{},a=await (0,x.Up)(e,{maxRetries:1,promiseArguments:e=>t(o(e)),onError:e=>{console.error({err:e,debugInfo:i});let t=[y._n.APP_BLOCKED_FOR_ORG,y._n.ITEM_ACCESS_UNAUTHORIZED,y._n.ITEM_NONEXISTENT_OR_INACCESSIBLE,y._n.SUBSCRIPTION_DISABLED,y._n.OWNER_SUBSCRIPTION_DISABLED,y._n.SUBSCRIPTION_CANCELED,y._n.INVALID_TOKEN,"HTTP 403"];return!(e instanceof Error&&(e instanceof f.yE&&t.includes(e.code)||"string"==typeof e.message&&/items\/[a-zA-Z0-9]{32}\/data/.test(e.message)&&"invalid-json"===e.type))}});return clearTimeout(s),a};var b=i(580279),v=i(820666),I=i(368667),S=i(972054),T=i(904845),k=i(518273),D=i(387703);let A=e=>{let{itemDetails:t,expectedItemType:i,url:a}=e,r=(0,m.qg)(t),n=r&&a&&!a.includes("/templates"),l=!r&&a&&a.includes("/templates");if(!(0,s.mT)(t,i)||n||l){let e=(0,m.HL)(t);throw new o.Z({type:"item-not-supported-on-route",itemType:e})}},C=async e=>{let{id:t,authManager:i,config:s,ctx:o,itemType:p,translationOptions:d,shouldRedirect:c}=e;if(p===g.o.Frame){if(!s.ENABLE_FRAMES)return{redirect:{asPath:`${s.BASE_URL}/error`},success:!1};if(o?.req?.url?.includes("test"))return $(s,t)}if(!t)throw Error(`no ${p} id`);if(void 0!==o){let{res:e}=o;e?.setHeader?.("Vary","Cookie")}let h={itemId:t,authManager:i,portalHost:s.PORTAL_HOST},u=!1,f={...h,type:p,config:s};try{let[g,y]=await Promise.all([w(a.Z.fetchItemDetails,e=>[{...h,signal:e}],{function:"StoryItemViewer.fetchItemDetails",id:t,itemType:p}),w(a.Z.fetchPublishedItemData,e=>[{...f,signal:e}],{function:"StoryItemViewer.fetchPublishedItemData",id:t,itemType:p})]);u=(0,m.qg)(g),A({itemDetails:g,expectedItemType:p,url:o?.req?.url});let x=(0,r.kz)(y),S=d?.locale?(0,b.dA)(d.locale,d.supportedLanguages,d.fallbackLanguage):void 0;S&&v.G(g)?.translations?.[S]&&d?.autoTranslationTypeKeyword&&(0,m._$)({typeKeywords:g.typeKeywords,typeKeywordId:d.autoTranslationTypeKeyword})?(x=x?d.locale:void 0,y=await w(a.Z.fetchPublishedItemData,e=>[{...f,language:S,signal:e}],{function:"fetchPublishedItemData",id:t,itemType:p})):S&&d?.locale&&x?.startsWith(S)&&(x=d.locale);let k=await w(n.ir,e=>[{storyItemData:y,authManager:i,portalHost:s.PORTAL_HOST,signal:e}],{function:"fetchThemeItemInfo",id:t,itemType:p});if((0,I.ZX)(g)||(0,m.bk)(g)&&("admin"===g.itemControl||"update"===g.itemControl)){let e=(0,l.N)(p,u),i=`/${e}/edit?id=${t}`,a=`${s.BASE_URL}/${e}/${t}/edit`;return c&&(0,T.j)({ctx:o,href:i,asPath:a}),{redirect:{asPath:a},success:!1}}if("public"!==g.access&&i)try{if(await w(D.T,e=>[{authManager:i,config:s,signal:e}],{function:"getUserAuthorization",id:t,itemType:p})==="user-unauthorized")throw Error("user-unauthorized")}catch(e){if(c)throw e;return{redirect:{asPath:`${s.BASE_URL}/error`},success:!1}}let C="";if(void 0!==o){let{req:t,res:i}=o;i&&"function"==typeof i.setHeader&&("public"===g.access?i.setHeader("Cache-Control",`public, max-age=${e.skipCache?0:s.CACHE_MAX_AGE}`):i.setHeader("Cache-Control",`private, max-age=${e.skipCache?0:s.NON_PUBLIC_CACHE_MAX_AGE}`)),C=t?.headers.host||""}return{id:t,itemDetails:g,publishedData:y,host:C,initialThemeItemInfo:k,...x?{pageLocale:x}:{},success:!0}}catch(t){return j(t,{...e,isTemplate:u})}},j=(e,t)=>{let{id:i,authManager:s,config:a,ctx:r,signInUrl:n,itemType:d,isTemplate:c,shouldRedirect:h}=t;if(e&&e.code)try{return(0,k.q)({ctx:r,authManager:s,signInUrl:n,error:e,config:a}),{redirect:{asPath:""},error:e,success:!1}}catch(e){throw new o.Z(e)}else if("string"==typeof e.message&&e.message.search(`items/${i}/data`)>=0&&"invalid-json"===e.type){let t=d===g.o.Collection?"edit":"preview",s=(0,l.N)(d,c);return h&&(0,T.j)({ctx:r,href:`/${s}/${t}?id=${i}`,asPath:`${a.BASE_URL}/${s}/${i}/${t}`}),{redirect:{asPath:`${a.BASE_URL}/${s}/${i}/${t}`},error:e,success:!1}}else{if("string"==typeof e.message&&"user-unauthorized"===e.message)return h&&(0,T.j)({ctx:r,href:`/error?errType=unsupported-account&itemType=${d}`,asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${d}`}),{redirect:{asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${d}`},error:e,success:!1};if("string"!=typeof e.message||"item-not-supported-on-route"!==e.message||!i)return h&&(0,T.j)({ctx:r,href:`/error?itemType=${d}`,asPath:`${a.BASE_URL}/error?itemType=${d}`}),{redirect:{asPath:`${a.BASE_URL}/error?itemType=${d}`},error:e,success:!1};let o=t.convertRoute({routeDef:(0,p.kN)({route:"viewer",itemType:e.itemType,isTemplate:c,itemId:i}),featureDecisions:{canAccessExternalUrls:!1},config:a,authManager:s}),n="error?errType=item-not-supported-on-route`",l=`${a.BASE_URL}/${n}`;return h&&(0,T.j)({ctx:r,href:L(o.href,n),asPath:o.as||l}),{redirect:{asPath:o.as||l},success:!1}}},P=async e=>{let{id:t,authManager:i,config:s,ctx:a,signInUrl:h,itemType:u,shouldRedirect:g}=e;if(!t)throw Error(`no ${u} id`);if(t===d.BD)return _(e);let f={itemId:t,authManager:i,portalHost:s.PORTAL_HOST},y=!1;try{let e=await c.ZP.fetchItemDetails(f);y=(0,m.qg)(e);let p=(0,l.N)(u,y);if(A({itemDetails:e,expectedItemType:u,url:a?.req?.url}),e.origin)return g&&(0,T.j)({ctx:a,href:`/${p}/${t}`,asPath:`${s.BASE_URL}/${p}/${t}`}),{success:!1,redirect:{asPath:`${s.BASE_URL}/${p}/${t}`}};if("update"===e.itemControl||"admin"===e.itemControl){if((0,I.ZX)(e)||(0,m.bk)(e))return g&&(0,T.j)({ctx:a,href:`/${p}/edit?id=${t}`,asPath:`${s.BASE_URL}/${p}/${t}/edit`}),{success:!1,redirect:{asPath:`${s.BASE_URL}/${p}/${t}/edit`}};if(void 0!==a){let{res:e}=a;e&&"function"==typeof e.setHeader&&e.setHeader("Cache-Control","max-age=0, private, must-revalidate")}let{itemData:o}=await c.ZP.fetchItemDraftData({itemDetails:e,type:u,authManager:i,portalHost:s.PORTAL_HOST,config:s}),l=await (0,n.ir)({storyItemData:o,authManager:i,portalHost:s.PORTAL_HOST}),d=(0,r.kz)(o);return{success:!0,id:t,itemDetails:e,draftData:o,initialThemeItemInfo:l,pageLocale:d}}throw new o.Z({type:"story-privileges-preview",itemType:u})}catch(r){if("string"==typeof r.message&&"item-not-supported-on-route"===r.message&&t){let o=e.convertRoute({routeDef:(0,p.kN)({route:"preview",itemType:r.itemType,itemId:t,isTemplate:y}),featureDecisions:{canAccessExternalUrls:!1},config:s,authManager:i}),n="error?errType=item-not-supported-on-route`",l=`${s.BASE_URL}/${n}`;return g&&(0,T.j)({ctx:a,href:L(o.href,n),asPath:o.as||l}),{redirect:{asPath:o.as||l},success:!1}}if(r instanceof o.Z)throw new o.Z(r);return(0,k.q)({ctx:a,authManager:i,signInUrl:h,error:r,config:s}),{redirect:{asPath:""},error:r,success:!1}}},_=e=>{let{config:t,formatMessage:i}=e;return{success:!0,...(0,d.kS)({formatMessage:i,baseUrl:t.BASE_URL,siteUrl:(0,S.o)({siteUrl:t.SITE_URL,isComponentMounted:!0}),productName:t.PRODUCT_NAME,baseThemeId:(0,h.TI)(t.INCLUDED_STORY_THEMES)}),initialThemeItemInfo:{}}},$=(e,t)=>{let i={...(0,u.rV)({itemType:g.o.Frame,config:e,isTemplate:!1}),created:13462453245,modified:13462453245,owner:"ton12618@esri.com",numViews:1e4,id:t||"",size:2};return{id:t||"",itemDetails:i,publishedData:(0,u.Fn)(e.BASE_URL),host:"",initialThemeItemInfo:{},success:!0}},L=(e,t)=>"object"==typeof e&&e.pathname?e.pathname:"string"==typeof e?e:t},518273:function(e,t,i){i.d(t,{q:function(){return c}});var s=i(718895),o=i(96606),a=i(293786),r=i(641391),n=i(768995);class l extends Error{constructor(e){super(),this.name="WebsiteError",this.type=this.message=e;let{statusCode:t}=(0,n.P)(this.type);this.statusCode=t}}var p=i(904845),d=i(834406);let c=e=>{let t;if((0,o.F8)(d.env.DISABLE_REDIRECT_ON_LOAD_ERROR)){console.error("\uD83D\uDD34 Error occurred when loading the page. Page is not redirected because of DISABLE_REDIRECT_ON_LOAD_ERROR flag. Heres the error, if any:",e.error);return}let{authManager:i,error:n,signInUrl:c,config:h,ctx:u}=e,m=e=>{(0,p.j)({ctx:u,asPath:`${h.BASE_URL}${e}`,href:e})};if(!n||!n.code){m("/error?errType=story-load");return}let g=e.ctx?.pathname;switch(t=g?.includes("/collections/")?a.o.Collection:g?.includes("/themes/")?a.o.Theme:a.o.Story,n.code){case r._n.ITEM_ACCESS_UNAUTHORIZED:if(i&&i.token)throw new s.Z({type:"story-inaccessible",itemType:t});(0,p.j)({ctx:u,href:c,isExternal:!0});break;case r._n.SUBSCRIPTION_CANCELED:case r._n.SUBSCRIPTION_DISABLED:case r._n.OWNER_SUBSCRIPTION_DISABLED:m("/error?errType=story-inaccessible");break;case r._n.ITEM_NONEXISTENT_OR_INACCESSIBLE:throw new s.Z({type:"story-not-found",itemType:t});case r._n.APP_BLOCKED_FOR_ORG:throw new l("blocked-org");default:{let e=n?.response?.error?.code;if(403===e)throw new s.Z({type:"story-inaccessible",itemType:t});if(400===e||404===e)throw new s.Z({type:"story-not-found",itemType:t});throw new s.Z({type:"story-load",itemType:t})}}}}}]);